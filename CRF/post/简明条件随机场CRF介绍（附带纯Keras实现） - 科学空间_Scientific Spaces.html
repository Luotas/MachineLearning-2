<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0030)https://kexue.fm/archives/5542 -->
<html xmlns="http://www.w3.org/1999/xhtml"><!-- 页面设计者：www.laogui.com --><!-- 页面完善者：www.kexue.fm --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta baidu-gxt-verify-token="2e7e16245e9e60b47ef9abf7da323d7f">
    <meta name="baidu-site-verification" content="ovVHx28ijH">
    <meta name="baidu-site-verification" content="aAbtts7I8Y">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- google验证 -->
    <meta name="google-site-verification" content="2OH3qUDPmSsnHkKhUC7j3EEhESVaHJObE6YuwxWNw4c">
    <meta name="google-site-verification" content="1IF-re5N9bZpBaUiwSAARvUyPkEomCWxrQU4YkVZfIE">
    
    <!-- 百度推送 -->
<script src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/hm.js"></script><script src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/push.js"></script><script>
(function(){
    var bp = document.createElement('script');
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="applicable-device" content="pc,mobile">
    <meta name="apple-mobile-web-app-title" content="Scientific Spaces">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <title>简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间|Scientific Spaces</title>

    <!-- 使用url函数转换相关路径 -->
    <link rel="stylesheet" href="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/style.css">
    <link rel="stylesheet" href="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/prism.css">
    <link rel="shortcut icon" href="https://kexue.fm/usr/themes/geekg/favicon.ico">
    <link rel="pingback" href="https://kexue.fm/index.php/action/xmlrpc">
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://kexue.fm/action/xmlrpc?rsd">
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://kexue.fm/action/xmlrpc?wlw">

    <!-- 通过自有函数输出HTML头部信息 -->
    <meta name="description" content="笔者去年曾写过博文《果壳中的条件随机场(CRF In A Nutshell)》，以一种比较粗糙的方式介绍了一下条件随机场（CRF）模型。然而那篇文章显然有很多不足的地方，比如介绍不够清晰，也不够...">
<meta name="keywords" content="模型,概率图,keras">
<meta name="generator" content="Typecho 1.1/17.10.30">
<meta name="template" content="geekg">
<link rel="pingback" href="https://kexue.fm/action/xmlrpc">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://kexue.fm/action/xmlrpc?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://kexue.fm/action/xmlrpc?wlw">
<link rel="alternate" type="application/rss+xml" title="简明条件随机场CRF介绍（附带纯Keras实现） » 科学空间|Scientific Spaces » RSS 2.0" href="https://kexue.fm/feed/archives/5542">
<link rel="alternate" type="application/rdf+xml" title="简明条件随机场CRF介绍（附带纯Keras实现） » 科学空间|Scientific Spaces » RSS 1.0" href="https://kexue.fm/feed/rss/archives/5542">
<link rel="alternate" type="application/atom+xml" title="简明条件随机场CRF介绍（附带纯Keras实现） » 科学空间|Scientific Spaces » ATOM 1.0" href="https://kexue.fm/feed/atom/archives/5542">
<script type="text/javascript">
(function () {
    window.TypechoComment = {
        dom : function (id) {
            return document.getElementById(id);
        },
    
        create : function (tag, attr) {
            var el = document.createElement(tag);
        
            for (var key in attr) {
                el.setAttribute(key, attr[key]);
            }
        
            return el;
        },

        reply : function (cid, coid) {
            var comment = this.dom(cid), parent = comment.parentNode,
                response = this.dom('respond-post-5542'), input = this.dom('comment-parent'),
                form = 'form' == response.tagName ? response : response.getElementsByTagName('form')[0],
                textarea = response.getElementsByTagName('textarea')[0];

            if (null == input) {
                input = this.create('input', {
                    'type' : 'hidden',
                    'name' : 'parent',
                    'id'   : 'comment-parent'
                });

                form.appendChild(input);
            }

            input.setAttribute('value', coid);

            if (null == this.dom('comment-form-place-holder')) {
                var holder = this.create('div', {
                    'id' : 'comment-form-place-holder'
                });

                response.parentNode.insertBefore(holder, response);
            }

            comment.appendChild(response);
            this.dom('cancel-comment-reply-link').style.display = '';

            if (null != textarea && 'text' == textarea.name) {
                textarea.focus();
            }

            return false;
        },

        cancelReply : function () {
            var response = this.dom('respond-post-5542'),
            holder = this.dom('comment-form-place-holder'), input = this.dom('comment-parent');

            if (null != input) {
                input.parentNode.removeChild(input);
            }

            if (null == holder) {
                return true;
            }

            this.dom('cancel-comment-reply-link').style.display = 'none';
            holder.parentNode.insertBefore(response, holder);
            return false;
        }
    };
})();
</script>
<script type="text/javascript">
(function () {
    var event = document.addEventListener ? {
        add: 'addEventListener',
        triggers: ['scroll', 'mousemove', 'keyup', 'touchstart'],
        load: 'DOMContentLoaded'
    } : {
        add: 'attachEvent',
        triggers: ['onfocus', 'onmousemove', 'onkeyup', 'ontouchstart'],
        load: 'onload'
    }, added = false;

    document[event.add](event.load, function () {
        var r = document.getElementById('respond-post-5542'),
            input = document.createElement('input');
        input.type = 'hidden';
        input.name = '_';
        input.value = (function () {
    var _wDpYzMJ = 'e00'//'vq8'
+'Ob'//'Ob'
+'7'//'SL'
+/* 'Q'//'Q' */''+'58'//'N'
+//'H'
'24'+''///*'0F'*/'0F'
+//'zzU'
'4f'+'e'//'n'
+//'t'
'98'+//'jQ1'
'00b'+'7Q'//'7Q'
+/* 'N'//'N' */''+'3'//'HW'
+//'p'
'4'+//'YX3'
'5'+'5e'//'D'
+'95f'//'9X'
+'3'//'xUI'
+//'GzS'
'949'+//'7oD'
'd6'+''///*'W'*/'W'
+//'x'
'1d', _SB3p1L7 = [[3,5],[16,18]];
    
    for (var i = 0; i < _SB3p1L7.length; i ++) {
        _wDpYzMJ = _wDpYzMJ.substring(0, _SB3p1L7[i][0]) + _wDpYzMJ.substring(_SB3p1L7[i][1]);
    }

    return _wDpYzMJ;
})();

        if (null != r) {
            var forms = r.getElementsByTagName('form');
            if (forms.length > 0) {
                function append() {
                    if (!added) {
                        forms[0].appendChild(input);
                        added = true;
                    }
                }
            
                for (var i = 0; i < event.triggers.length; i ++) {
                    var trigger = event.triggers[i];
                    document[event.add](trigger, append);
                    window[event.add](trigger, append);
                }
            }
        }
    });
})();
</script>
    <script src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/prism.js"></script>

    <!-- 导入jquery，目前只有ajax评论翻页用到了 -->
    <script src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/jquery.js"></script>
    
    <!-- 下面三个都是为移动端侧边栏准备的 -->
    <script src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/prototype.js"></script>
    <script src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/effects.js"></script>
    <script src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/side-bar.js"></script>

    <script type="text/x-mathjax-config;executed=true">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
            TeX: {equationNumbers: {autoNumber: ["AMS"], useLabelIds: true}, extensions: ["AMSmath.js", "AMSsymbols.js", "extpfeil.js"]},
            "HTML-CSS": {linebreaks: {automatic: true, width: "95% container"}, noReflows: false},
            "PreviewHTML": {linebreaks: {automatic: true, width: "95% container"}, noReflows: false},
            "CommonHTML": {linebreaks: {automatic: true, width: "95% container"}, noReflows: false},
            "SVG": {linebreaks: {automatic: true, width: "95% container"}, noReflows: false}
        });
    </script>
    
    <script type="text/javascript" src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/MathJax.js"></script>

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.4') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.4') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.4') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.4') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.4') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.4') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.4') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.4') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.4') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_Math-bold-italic; src: url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff?V=2.7.4') format('woff'), url('https://kexue.fm/sci/MathJax-2.7.4/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf?V=2.7.4') format('opentype')}
</style></head>

<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br></div></div><div id="MathJax_Message" style="display: none;"></div>


<div id="Container">

    <div id="Header">

        <div id="MobileSideBar">
        
        <a id="MobileSideBarTab"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/slide-button.png" alt="MobileSideBar" title="MobileSideBar"></a>
        
        <div id="MobileSideBarContents" style="display:none;">
            <div class="MobileSideBarContentsInner">
                <h2>SEARCH</h2>
                <div class="search d5">
                    <form action="https://kexue.fm/archives/5542" method="post"><input type="text" name="s" placeholder="搜索从这里开始..."></form>
                </div>
            </div>

            <div class="MobileSideBarContentsInner">
                <div class="MobileSideBar_two_columns">
                </div>
            </div>

            <div class="MobileSideBarContentsInner">
                <h2>MENU</h2>
                <div class="MobileSideBar_two_columns">
                    <ul>
                        <li><a href="https://kexue.fm/reward.html">打赏</a></li><li><a href="https://kexue.fm/latex.html">公式</a></li><li><a href="https://kexue.fm/ac.html">天象</a></li><li><a href="https://kexue.fm/links.html">链接</a></li><li><a href="https://kexue.fm/me.html">时光</a></li><li><a href="https://kexue.fm/science.html">博览</a></li><li><a href="https://kexue.fm/content.html">归档</a></li>                    </ul>
                </div>
            </div>
            
            <div class="MobileSideBarContentsInner">
                <h2>CATEGORIES</h2>
                <div class="MobileSideBar_two_columns">
                    <ul>
                        <li><a href="https://kexue.fm/category/Everything">千奇百怪</a></li><li><a href="https://kexue.fm/category/Astronomy">天文探索</a></li><li><a href="https://kexue.fm/category/Mathematics">数学研究</a></li><li><a href="https://kexue.fm/category/Phy-chem">物理化学</a></li><li><a href="https://kexue.fm/category/Big-Data">信息时代</a></li><li><a href="https://kexue.fm/category/Biology">生物自然</a></li><li><a href="https://kexue.fm/category/photograph">图片摄影</a></li><li><a href="https://kexue.fm/category/Questions">问题百科</a></li><li><a href="https://kexue.fm/category/Life-Feeling">生活/情感</a></li><li><a href="https://kexue.fm/category/Resources">资源共享</a></li>                    </ul>
                </div>
            </div>

            <div class="MobileSideBarContentsInner">              
                <h2>NEWPOSTS</h2>
                <div class="MobileSideBar_one_column" id="MobileNewposts">
                    <ul> 
                                                                            <li><a href="https://kexue.fm/archives/7031">什么时候多进程的加速比可以大于1？</a></li>
                                                    <li><a href="https://kexue.fm/archives/7006">最小熵原理（五）：“层层递进”之社...</a></li>
                                                    <li><a href="https://kexue.fm/archives/6992">BN究竟起了什么作用？一个闭门造车的分析</a></li>
                                                    <li><a href="https://kexue.fm/archives/6985">“让Keras更酷一些！”：层与模...</a></li>
                                                    <li><a href="https://kexue.fm/archives/6933">从语言模型到Seq2Seq：Tra...</a></li>
                                                    <li><a href="https://kexue.fm/archives/6920">重新写了之前的新词发现算法：更快更...</a></li>
                                                    <li><a href="https://kexue.fm/archives/6919">百度实体链接比赛后记：行为建模和实体链接</a></li>
                                                    <li><a href="https://kexue.fm/archives/6915">自己实现了一个bert4keras</a></li>
                                                    <li><a href="https://kexue.fm/archives/6910">HSIC简介：一个有意思的判断相关...</a></li>
                                                    <li><a href="https://kexue.fm/archives/6906">开源一版DGCNN阅读理解问答模型...</a></li>
                                            </ul>
                </div>
            </div>

            <div class="MobileSideBarContentsInner">
                <h2>COMMENTS</h2>
                <div class="MobileSideBar_one_column" id="MobileComments">
                    <ul>
                                                            <li><a href="https://kexue.fm/archives/6214/comment-page-1#comment-12260"><font style="color: #ADCB83;">余嘉诚</font>: 苏老师,非常感谢您一直以来的论文分享,我有个问题,就是请问一下...</a></li>
                                            <li><a href="https://kexue.fm/archives/6915/comment-page-1#comment-12259"><font style="color: #ADCB83;">且放白鹿青崖间</font>: 谢谢你修改的代码，对我的帮助非常大</a></li>
                                            <li><a href="https://kexue.fm/archives/6736/comment-page-2#comment-12258"><font style="color: #ADCB83;">teddyl</font>: 已经过了些日子了，希望能与所帮助。
我也遇到类似问题，不过ke...</a></li>
                                            <li><a href="https://kexue.fm/archives/7031/comment-page-1#comment-12257"><font style="color: #ADCB83;">beader</font>: 词频统计的话 collections.Counter 会比 d...</a></li>
                                            <li><a href="https://kexue.fm/archives/7031/comment-page-1#comment-12256"><font style="color: #ADCB83;">smartsl</font>: 答：单进程算法太烂的时候。哈哈</a></li>
                                            <li><a href="https://kexue.fm/archives/3086/comment-page-1#comment-12253"><font style="color: #ADCB83;">Werner</font>: 受刻意练习理论的影响，我相信天生才华根本就不存在。</a></li>
                                            <li><a href="https://kexue.fm/archives/5542/comment-page-3#comment-12252"><font style="color: #ADCB83;">石语</font>: 老师您好，看了您的博客，收获颇丰，我现在有2个问题，期待您的解...</a></li>
                                            <li><a href="https://kexue.fm/archives/5807/comment-page-3#comment-12251"><font style="color: #ADCB83;">苏剑林</font>: 分母加<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.529em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.43em, 1000.45em, 2.331em, -999.996em); top: -2.098em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.106em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.671em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϵ</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">\epsilon</script>防止除零错误，另外学习率小一点。</a></li>
                                            <li><a href="https://kexue.fm/archives/5253/comment-page-7#comment-12250"><font style="color: #ADCB83;">chang li jun</font>: 非常感谢，我再理解理解</a></li>
                                            <li><a href="https://kexue.fm/archives/5807/comment-page-3#comment-12249"><font style="color: #ADCB83;">张兴远</font>: 苏神你好，我想问一下您在训练NICE或者GLOW的时候有没有遇...</a></li>
                                    </ul>
            </div>
        </div>

        <div class="MobileSideBarContentsInner">
            <h2>USERLOGIN</h2>
            <div class="MobileSideBar_one_column">
                <ul>
                                            <li style="float: none; width: 90%; margin: 4px 16px; padding: 2px 2px 2px 10px; background: transparent url(https://kexue.fm/usr/themes/geekg/images/widgetlisticon.gif) no-repeat scroll 0 center;"><a href="https://kexue.fm/admin/login.php" target="_blank">登录</a></li>
                                        
                </ul>
            </div>
        </div>
    </div>
    
</div>
        <div id="HeadLeft">
                            <div id="Hi"><a href="https://kexue.fm/">科学空间|Scientific Spaces</a></div>
                        <div id="MenuTop">
                <ul>
                                            <li><a href="https://kexue.fm/admin/login.php" target="_blank">登录</a></li>
                                        <li><a href="https://kexue.fm/reward.html">打赏</a></li><li><a href="https://kexue.fm/latex.html">公式</a></li><li><a href="https://kexue.fm/ac.html">天象</a></li><li><a href="https://kexue.fm/links.html">链接</a></li><li><a href="https://kexue.fm/me.html">时光</a></li><li><a href="https://kexue.fm/science.html">博览</a></li><li><a href="https://kexue.fm/content.html">归档</a></li>                </ul>
            </div>
            <div id="navigation">渴望成为一个小飞侠</div>
        </div>
        <div id="HeadRight">

            <div id="topnavbox">
                <ul>    
                    <li><a target="_blank" href="https://kexue.fm/feed"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/rss.png" alt=""><br>
                    欢迎订阅</a></li>
                    <li><a target="_blank" href="https://kexue.fm/archives/119"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/mail.png" alt=""><br>
                    个性邮箱</a></li>
                    <li><a target="_blank" href="https://kexue.fm/ac.html"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/Saturn.png" alt=""><br>
                    天象信息</a></li>
                    <li><a target="_blank" href="https://kexue.fm/archives/41"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/iss.png" alt=""><br>
                    观测ISS</a></li>
                    <li><a target="_blank" href="https://kexue.fm/latex.html"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/pi.png" alt=""><br>
                    LaTeX</a></li>
                    <li><a target="_blank" href="https://kexue.fm/me.html"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/mlogo.png" alt=""><br>
                    关于博主</a></li>
                </ul>
            </div>
            <div id="Submissions">
                <p>欢迎访问“科学空间”，这里将与您共同探讨自然科学，回味人生百态；也期待大家的分享～</p>
            </div>
        </div>
    </div>
    <div id="MainMenu">
        <ul>
            <li><a href="https://kexue.fm/category/Everything"><strong>千奇百怪</strong>Everything</a></li><li><a href="https://kexue.fm/category/Astronomy"><strong>天文探索</strong>Astronomy</a></li><li><a href="https://kexue.fm/category/Mathematics"><strong>数学研究</strong>Mathematics</a></li><li><a href="https://kexue.fm/category/Phy-chem"><strong>物理化学</strong>Phy-chem</a></li><li><a href="https://kexue.fm/category/Big-Data"><strong>信息时代</strong>Big-Data</a></li><li><a href="https://kexue.fm/category/Biology"><strong>生物自然</strong>Biology</a></li><li><a href="https://kexue.fm/category/photograph"><strong>图片摄影</strong>photograph</a></li><li><a href="https://kexue.fm/category/Questions"><strong>问题百科</strong>Questions</a></li><li><a href="https://kexue.fm/category/Life-Feeling"><strong>生活/情感</strong>Life-Feeling</a></li><li><a href="https://kexue.fm/category/Resources"><strong>资源共享</strong>Resources</a></li>        </ul>
    </div>

    <div id="MainMenuiPad">
        <div style="text-align: center;">
            <ul>
                <li><a href="https://kexue.fm/category/Everything"><strong>千奇百怪</strong></a></li><li><a href="https://kexue.fm/category/Astronomy"><strong>天文探索</strong></a></li><li><a href="https://kexue.fm/category/Mathematics"><strong>数学研究</strong></a></li><li><a href="https://kexue.fm/category/Phy-chem"><strong>物理化学</strong></a></li><li><a href="https://kexue.fm/category/Big-Data"><strong>信息时代</strong></a></li><li><a href="https://kexue.fm/category/Biology"><strong>生物自然</strong></a></li><li><a href="https://kexue.fm/category/photograph"><strong>图片摄影</strong></a></li><li><a href="https://kexue.fm/category/Questions"><strong>问题百科</strong></a></li><li><a href="https://kexue.fm/category/Life-Feeling"><strong>生活/情感</strong></a></li><li><a href="https://kexue.fm/category/Resources"><strong>资源共享</strong></a></li>            </ul>
        </div>
    </div>

<!-- end #header -->

<div id="MainBody">
    <div id="content">
        <div id="breadcrumb">
            <a href="https://kexue.fm/">首页</a>
            <a href="https://kexue.fm/category/Big-Data">信息时代</a>            简明条件随机场CRF介绍（附带纯Keras实现）        </div>
        <div class="Post">
            <div class="PostHead">
                <div class="date-wrap">
                    <span class="date-day">18</span>
                    <span class="date-month">May</span>
                </div>
                <div class="title-wrap">
                    <h1><a href="https://kexue.fm/archives/5542">简明条件随机场CRF介绍（附带纯Keras实现）</a></h1>
                    <span class="submitted">
                        <span>By </span>
                        <span>苏剑林</span> |
                        <span>2018-05-18</span> |
                        <span>54381位读者</span>
                        <span id="print"> | <input type="button" class="title_button" onclick="document.getElementById(&#39;SideBar&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;content&#39;).style.width = &#39;100%&#39;; document.getElementById(&#39;content&#39;).style.border = &#39;none&#39;; document.getElementById(&#39;Header&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;PostComment&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;comments&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;similar&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;breadcrumb&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;pay&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;tools&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;entrynavigation&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;content_tips&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;Container&#39;).style.padding = &#39;0&#39;; document.getElementById(&#39;Footer&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;MobileSideBar&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;MainMenu&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;MainMenuiPad&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;print&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;PostContent&#39;).style.color = &#39;#000&#39;; document.getElementById(&#39;Container&#39;).style.maxWidth = &#39;100%&#39;; document.body.style.background = &#39;none&#39;; document.getElementById(&#39;share&#39;).style.display = &#39;none&#39;; document.getElementById(&#39;to_cite&#39;).style.display = &#39;none&#39;; window.print();" value="打印"></span> <span id="to_cite"><input type="button" class="title_button" onclick="location.href=&#39;#how_to_cite&#39;" value="引用"></span> <span id="share">
    <input type="button" class="title_button" onclick="var to_share = document.getElementById(&#39;share_position&#39;); if (to_share.style.display === &#39;none&#39;) {to_share.style.display = &#39;inline-block&#39;;} else {to_share.style.display = &#39;none&#39;}" value="分享">
    <span id="share_position" style="display: none">
        :
        <input type="button" class="title_button" onclick="shareTo(&#39;qzone&#39;)" value="空间">
        <input type="button" class="title_button" onclick="shareTo(&#39;qq&#39;)" value="QQ">
        <input type="button" class="title_button" onclick="shareTo(&#39;sina&#39;)" value="微博">
        <input type="button" class="title_button" onclick="shareTo(&#39;wechat&#39;)" value="微信"> 
    </span>
</span>

<script type="text/javascript">
//一键分享
function shareTo(stype){
    //获取文章标题
    var share_title = document.title;
    //获取文章地址
    var share_url = document.location.href.split('#')[0];
    //获取文章描述
    var share_content = document.querySelector('meta[name="description"]').getAttribute('content');
    //获取文章第一章图片
    var share_img = document.getElementById('PostContent').getElementsByTagName('img')[0].src;
    if (share_img.indexOf('wx.png') >= 0) {
        //如果文章无图则用默认的logo
        share_img = 'https://kexue.fm/usr/uploads/2014/06/1891032154.png';
    }

    if(stype=='qzone'){
        window.open('https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+share_url+'&share_title='+share_title+'&pics='+share_img+'&summary='+share_content);
    }
    if(stype=='sina'){
        window.open('http://service.weibo.com/share/share.php?url='+share_url+'?sharesource=weibo&title='+share_title+'&pic='+share_img+'&appkey= 287385219');
    }
    if(stype == 'qq'){
        window.open('http://connect.qq.com/widget/shareqq/index.html?url='+share_url+'&title='+share_title+'&pics='+share_img+'&summary='+share_content+'&desc='+share_title);
    }
    if(stype == 'wechat'){
        //分享到微信实际上就是生成对应的二维码
        window.open('https://bshare.optimix.asia/barCode?site=weixin&url='+share_url);
    }
}
</script>                    </span> 
                </div>
            </div>
            <div class="PostContent" id="PostContent">

                <p>笔者去年曾写过博文<a href="https://kexue.fm/archives/4695" target="_blank">《果壳中的条件随机场(CRF In A Nutshell)》</a>，以一种比较粗糙的方式介绍了一下条件随机场（CRF）模型。然而那篇文章显然有很多不足的地方，比如介绍不够清晰，也不够完整，还没有实现，在这里我们重提这个模型，将相关内容补充完成。</p><p>本文是对CRF基本原理的一个简明的介绍。当然，“简明”是相对而言中，要想真的弄清楚CRF，免不了要提及一些公式，如果只关心调用的读者，可以直接移到文末。</p><h2 id="图示">图示<a href="https://kexue.fm/archives/5542#%E5%9B%BE%E7%A4%BA"> #</a></h2><p>按照之前的思路，我们依旧来对比一下普通的逐帧softmax和CRF的异同。</p><h3 id="逐帧softmax">逐帧softmax<a href="https://kexue.fm/archives/5542#%E9%80%90%E5%B8%A7softmax"> #</a></h3><p>CRF主要用于序列标注问题，可以简单理解为是<font color="red">给序列中的每一帧都进行分类</font>，既然是分类，很自然想到将这个序列用CNN或者RNN进行编码后，接一个全连接层用softmax激活，如下图所示<br>
</p><div class="pic-container"><div class="typecho-caption aligncenter" style="max-width: 400px"><div style="margin: 5px"><a href="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/1423717593.png" title="点击查看原图" target="_blank"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/1423717593.png" style="max-width: 100%" alt="逐帧softmax并没有直接考虑输出的上下文关联"></a></div><p class="typecho-caption-text">逐帧softmax并没有直接考虑输出的上下文关联</p></div></div><!--more--><p></p><h3 id="条件随机场">条件随机场<a href="https://kexue.fm/archives/5542#%E6%9D%A1%E4%BB%B6%E9%9A%8F%E6%9C%BA%E5%9C%BA"> #</a></h3><p>然而，当我们设计标签时，比如用s、b、m、e的4个标签来做字标注法的分词，目标输出序列本身会带有一些上下文关联，比如s后面就不能接m和e，等等。逐标签softmax并没有考虑这种输出层面的上下文关联，所以它意味着把这些关联放到了编码层面，希望模型能自己学到这些内容，但有时候会“强模型所难”。</p><p>而CRF则更直接一点，它<font color="red">将输出层面的关联分离了出来</font>，这使得模型在学习上更为“从容”：<br>
</p><div class="pic-container"><div class="typecho-caption aligncenter" style="max-width: 520px"><div style="margin: 5px"><a href="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/1181727067.png" title="点击查看原图" target="_blank"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/1181727067.png" style="max-width: 100%" alt="CRF在输出端显式地考虑了上下文关联"></a></div><p class="typecho-caption-text">CRF在输出端显式地考虑了上下文关联</p></div></div><p></p><h2 id="数学">数学<a href="https://kexue.fm/archives/5542#%E6%95%B0%E5%AD%A6"> #</a></h2><p>当然，如果仅仅是引入输出的关联，还不仅仅是CRF的全部，CRF的真正精巧的地方，是它<strong><font color="red">以路径为单位，考虑的是路径的概率</font></strong>。</p><h3 id="模型概要">模型概要<a href="https://kexue.fm/archives/5542#%E6%A8%A1%E5%9E%8B%E6%A6%82%E8%A6%81"> #</a></h3><p>假如一个输入有<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.647em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.65em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">n</script>帧，每一帧的标签有<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.518em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">k</script>种可能性，那么理论上就有<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 1.097em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.97em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="msubsup" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.571em; left: 0.518em;"><span class="mi" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>k</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-4">k^n</script>中不同的输出。我们可以将它用如下的网络图进行简单的可视化。在下图中，每个点代表一个标签的可能性，点之间的连线表示标签之间的关联，而每一种标注结果，都对应着图上的一条完整的路径。<br>
</p><div class="pic-container"><div class="typecho-caption aligncenter" style="max-width: 450px"><div style="margin: 5px"><a href="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/2848452389.png" title="点击查看原图" target="_blank"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/2848452389.png" style="max-width: 100%" alt="4tag分词模型中输出网络图"></a></div><p class="typecho-caption-text">4tag分词模型中输出网络图</p></div></div><p></p><p>而在序列标注任务中，我们的正确答案是一般是唯一的。比如“今天天气不错”，如果对应的分词结果是“今天/天气/不/错”，那么目标输出序列就是bebess，除此之外别的路径都不符合要求。换言之，在序列标注任务中，我们的研究的基本单位应该是路径，我们要做的事情，是从<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-15" style="width: 1.097em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.97em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-16"><span class="msubsup" id="MathJax-Span-17"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.571em; left: 0.518em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>k</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">k^n</script>条路径选出正确的一条，那就意味着，如果将它视为一个分类问题，那么将是<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-20" style="width: 1.097em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.97em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-21"><span class="msubsup" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.571em; left: 0.518em;"><span class="mi" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>k</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-6">k^n</script>类中选一类的分类问题！</p><p>这就是逐帧softmax和CRF的根本不同了：<strong><font color="red">前者将序列标注看成是<u><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-25" style="width: 0.705em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.641em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.534em, 1000.64em, 2.363em, -999.997em); top: -2.165em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">n</script>个<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 0.577em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.279em, 1000.51em, 2.363em, -999.997em); top: -2.165em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">k</script>分类</u>问题，后者将序列标注看成是<u><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 0.577em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.342em, 1000.45em, 2.363em, -999.997em); top: -2.165em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mn" id="MathJax-Span-33" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-9">1</script>个<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-34" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px; font-size: 112%;"><span style="position: absolute; clip: rect(1.279em, 1000.96em, 2.363em, -999.997em); top: -2.165em; left: 0em;"><span class="mrow" id="MathJax-Span-35"><span class="msubsup" id="MathJax-Span-36"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(1.279em, 1000.51em, 2.363em, -999.997em); top: -2.165em; left: 0em;"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span><span style="position: absolute; top: -2.548em; left: 0.513em;"><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>k</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-10">k^n</script>分类</u>问题。</font></strong></p><p>具体来讲，在CRF的序列标注问题中，我们要计算的是条件概率<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-39" style="width: 100%; display: inline-block; min-width: 30.763em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 30.763em;"><span style="position: absolute; clip: rect(3.028em, 1026.52em, 4.443em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-40"><span class="mtable" id="MathJax-Span-41" style="min-width: 30.763em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 30.763em;"><span style="display: inline-block; position: absolute; width: 26.58em; height: 0px; clip: rect(-0.962em, 1026.52em, 0.454em, -999.997em); top: 0em; left: 50%; margin-left: -13.253em;"><span style="position: absolute; clip: rect(3.092em, 1026.52em, 4.443em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 26.58em; height: 0px;"><span style="position: absolute; clip: rect(1.226em, 1026.52em, 2.642em, -999.997em); top: -2.185em; left: 50%; margin-left: -13.253em;"><span class="mtd" id="MathJax-Span-45"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-49"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-51" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-55" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-61"><span style="display: inline-block; position: relative; width: 1.033em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.582em;"><span class="mn" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-67" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.033em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.582em;"><span class="mi" id="MathJax-Span-69" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math-italic; padding-left: 0.261em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-74"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-80" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-82" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-83"><span class="mrow" id="MathJax-Span-84"><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-89" style="height: 0em; vertical-align: 0em; width: 1.033em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main; padding-left: 0.261em;">(</span><span class="msubsup" id="MathJax-Span-93"><span style="display: inline-block; position: relative; width: 1.033em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.582em;"><span class="mn" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-99" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.033em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.582em;"><span class="mi" id="MathJax-Span-101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.29em; height: 0px; clip: rect(-0.898em, 1001.23em, 0.454em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.185em; right: 0em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-43"><span class="mtext" id="MathJax-Span-44" style="font-family: MathJax_Main;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-1"><mtext>(1)</mtext></mtd><mtd><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>,</mo><mspace width="1em"></mspace><mi mathvariant="bold-italic">x</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">P(y_1,\dots,y_n|x_1,\dots,x_n)=P(y_1,\dots,y_n|\boldsymbol{x}),\quad \boldsymbol{x}=(x_1,\dots,x_n)\tag{1}</script><br>
为了得到这个概率的估计，CRF做了两个假设：</p><blockquote class="cite"><div class="quote_cite"><strong><font color="blue">假设一</font></strong> 该分布是指数族分布。</div></blockquote><p>这个假设意味着存在函数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-103" style="width: 7.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.567em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1006.5em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-109" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-113" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-117" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">f(y_1,\dots,y_n;\boldsymbol{x})</script>，使得<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-2&quot;&gt;&lt;mtext&gt;(2)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-119" style="width: 100%; display: inline-block; min-width: 24.134em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 24.134em;"><span style="position: absolute; clip: rect(2.384em, 1019.76em, 5.087em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-120"><span class="mtable" id="MathJax-Span-121" style="min-width: 24.134em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 24.134em;"><span style="display: inline-block; position: absolute; width: 19.952em; height: 0px; clip: rect(-1.606em, 1019.76em, 1.097em, -999.997em); top: 0em; left: 50%; margin-left: -9.971em;"><span style="position: absolute; clip: rect(2.384em, 1019.76em, 5.087em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 19.952em; height: 0px;"><span style="position: absolute; clip: rect(1.676em, 1019.76em, 4.443em, -999.997em); top: -3.279em; left: 50%; margin-left: -9.971em;"><span class="mtd" id="MathJax-Span-125"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-129"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-135" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-137" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-138"><span class="mrow" id="MathJax-Span-139"><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mfrac" id="MathJax-Span-144" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px; margin-right: 0.132em; margin-left: 0.132em;"><span style="position: absolute; clip: rect(1.355em, 1000.45em, 2.384em, -999.997em); top: -2.893em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-145" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.226em, 1002.13em, 2.642em, -999.997em); top: -1.412em; left: 50%; margin-left: -1.091em;"><span class="mrow" id="MathJax-Span-146"><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(0.84em, 1002.32em, 1.29em, -999.997em); top: -1.284em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.32em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.097em;"></span></span></span></span><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Main;">exp</span><span class="mo" id="MathJax-Span-152"></span><span class="texatom" id="MathJax-Span-153" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-154"><span class="mo" id="MathJax-Span-155" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-164" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-166" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-167" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-170" style=""><span class="mrow" id="MathJax-Span-171"><span class="mo" id="MathJax-Span-172" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.221em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.29em; height: 0px; clip: rect(-1.026em, 1001.23em, 0.389em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.249em; right: 0em;"><span class="mtd" id="mjx-eqn-2"><span class="mrow" id="MathJax-Span-123"><span class="mtext" id="MathJax-Span-124" style="font-family: MathJax_Main;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.068em; border-left: 0px solid; width: 0px; height: 2.718em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-2"><mtext>(2)</mtext></mtd><mtd><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">)</mo></mrow></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">P(y_1,\dots,y_n|\boldsymbol{x})=\frac{1}{Z(\boldsymbol{x})}\exp\Big(f(y_1,\dots,y_n;\boldsymbol{x})\Big)\tag{2}</script><br>
其中<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-173" style="width: 2.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.191em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1002.13em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-14">Z(\boldsymbol{x})</script>是归一化因子，因为这个是条件分布，所以归一化因子跟<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-179" style="width: 0.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.647em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.58em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">x</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">\boldsymbol{x}</script>有关。这个<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-182" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.58em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-183"><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">f</script>函数可以视为一个打分函数，打分函数取指数并归一化后就得到概率分布。</p><blockquote class="cite"><div class="quote_cite"><strong><font color="blue">假设二</font></strong> 输出之间的关联仅发生在相邻位置，并且关联是指数加性的。</div></blockquote><p>这个假设意味着<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-185" style="width: 7.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.567em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1006.5em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-189"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-195" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">f(y_1,\dots,y_n;\boldsymbol{x})</script>可以更进一步简化为<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-3&quot;&gt;&lt;mtext&gt;(3)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-201" style="width: 100%; display: inline-block; min-width: 36.168em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 36.168em;"><span style="position: absolute; clip: rect(2.32em, 1031.73em, 5.151em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-202"><span class="mtable" id="MathJax-Span-203" style="min-width: 36.168em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 36.168em;"><span style="display: inline-block; position: absolute; width: 31.985em; height: 0px; clip: rect(-1.67em, 1031.73em, 1.162em, -999.997em); top: 0em; left: 50%; margin-left: -16.02em;"><span style="position: absolute; clip: rect(2.32em, 1031.73em, 5.151em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 31.985em; height: 0px;"><span style="position: absolute; clip: rect(2.32em, 1031.73em, 5.151em, -999.997em); top: -3.986em; left: 50%; margin-left: -16.02em;"><span class="mtd" id="MathJax-Span-207"><span class="mrow" id="MathJax-Span-208"><span class="mtable" id="MathJax-Span-209" style="padding-right: 0.196em; padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 31.599em; height: 0px;"><span style="position: absolute; clip: rect(2.384em, 1007.53em, 4.894em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.597em; height: 0px;"><span style="position: absolute; clip: rect(1.226em, 1007.53em, 2.642em, -999.997em); top: -2.828em; right: 0em;"><span class="mtd" id="MathJax-Span-210"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-214"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-220" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(3.8em, 1000em, 4.186em, -999.997em); top: -3.279em; right: 0em;"><span class="mtd" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(2.384em, 1023.94em, 5.151em, -999.997em); top: -3.986em; left: 7.597em;"><span style="display: inline-block; position: relative; width: 24.006em; height: 0px;"><span style="position: absolute; clip: rect(1.226em, 1023.94em, 2.642em, -999.997em); top: -2.828em; left: 0em;"><span class="mtd" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-244" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">h</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-253"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-262"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-264" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-266" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">h</span><span class="mo" id="MathJax-Span-274" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-275"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-277" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.226em, 1013.45em, 2.642em, -999.997em); top: -1.477em; left: 0em;"><span class="mtd" id="MathJax-Span-283"><span class="mrow" id="MathJax-Span-284"><span class="mi" id="MathJax-Span-285"></span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main; padding-left: 0.196em;">⋯</span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-291"><span style="display: inline-block; position: relative; width: 1.934em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-293"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-298" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-299" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">h</span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-308"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.29em; height: 0px; clip: rect(-0.962em, 1001.23em, 0.454em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.185em; right: 0em;"><span class="mtd" id="mjx-eqn-3"><span class="mrow" id="MathJax-Span-205"><span class="mtext" id="MathJax-Span-206" style="font-family: MathJax_Main;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-3"><mtext>(3)</mtext></mtd><mtd><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo></mtd><mtd><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>3</mn></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>3</mn></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>+</mo><mo>⋯</mo><mo>+</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>n</mi></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mtr></mtable></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">\begin{aligned}f(y_1,\dots,y_n;\boldsymbol{x})=&h(y_1;\boldsymbol{x})+g(y_1,y_2;\boldsymbol{x})+h(y_2;\boldsymbol{x})+g(y_2,y_3;\boldsymbol{x})+h(y_3;\boldsymbol{x})\\ 
&+\dots+g(y_{n-1},y_n;\boldsymbol{x})+h(y_n;\boldsymbol{x})\end{aligned}\tag{3}</script><br>
这也就是说，现在我们只需要对每一个标签和每一个相邻标签对分别打分，然后将所有打分结果求和得到总分。</p><h3 id="线性链CRF">线性链CRF<a href="https://kexue.fm/archives/5542#%E7%BA%BF%E6%80%A7%E9%93%BECRF"> #</a></h3><p>尽管已经做了大量简化，但一般来说，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-314" style="width: 1.419em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.29em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-315"><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-317" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">(3)</script>式所表示的概率模型还是过于复杂，难以求解。于是考虑到当前深度学习模型中，<u>RNN或者层叠CNN等模型已经能够比较充分捕捉各个<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-319" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.518em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-320"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">y</script>与输入<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-322" style="width: 0.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.647em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.58em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-323"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">x</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">\boldsymbol{x}</script>的联系，因此，我们不妨考虑函数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-325" style="width: 0.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.45em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">g</script>跟<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-328" style="width: 0.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.647em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.58em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-329"><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">x</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">\boldsymbol{x}</script>无关</u>，那么<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-4&quot;&gt;&lt;mtext&gt;(4)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-331" style="width: 100%; display: inline-block; min-width: 27.03em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 27.03em;"><span style="position: absolute; clip: rect(2.32em, 1022.59em, 5.151em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-332"><span class="mtable" id="MathJax-Span-333" style="min-width: 27.03em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 27.03em;"><span style="display: inline-block; position: absolute; width: 22.847em; height: 0px; clip: rect(-1.67em, 1022.59em, 1.162em, -999.997em); top: 0em; left: 50%; margin-left: -11.451em;"><span style="position: absolute; clip: rect(2.32em, 1022.59em, 5.151em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 22.847em; height: 0px;"><span style="position: absolute; clip: rect(2.32em, 1022.59em, 5.151em, -999.997em); top: -3.986em; left: 50%; margin-left: -11.451em;"><span class="mtd" id="MathJax-Span-337"><span class="mrow" id="MathJax-Span-338"><span class="mtable" id="MathJax-Span-339" style="padding-right: 0.196em; padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 22.461em; height: 0px;"><span style="position: absolute; clip: rect(2.384em, 1011.97em, 4.958em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.037em; height: 0px;"><span style="position: absolute; clip: rect(1.226em, 1011.97em, 2.642em, -999.997em); top: -2.828em; right: 0em;"><span class="mtd" id="MathJax-Span-340"><span class="mrow" id="MathJax-Span-341"><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-344"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-346" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-350" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-353" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-356" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math-italic; padding-left: 0.261em;">h</span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-359"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-361" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-364" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-365" style="font-family: MathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.419em, 1000.71em, 2.449em, -999.997em); top: -1.477em; right: 0em;"><span class="mtd" id="MathJax-Span-389"><span class="mrow" id="MathJax-Span-390"><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(2.384em, 1010.36em, 5.151em, -999.997em); top: -3.986em; left: 12.037em;"><span style="display: inline-block; position: relative; width: 10.428em; height: 0px;"><span style="position: absolute; clip: rect(1.226em, 1010.36em, 2.642em, -999.997em); top: -2.828em; left: 0em;"><span class="mtd" id="MathJax-Span-366"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-369" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-370"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-374" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-376" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-378" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">h</span><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-381"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-383" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-384" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mo" id="MathJax-Span-388" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.226em, 1009.01em, 2.642em, -999.997em); top: -1.477em; left: 0em;"><span class="mtd" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-395" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-396"><span style="display: inline-block; position: relative; width: 1.934em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-398"><span class="mrow" id="MathJax-Span-399"><span class="mi" id="MathJax-Span-400" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-401" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-404" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-406" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">h</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-411"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-413" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-414" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.29em; height: 0px; clip: rect(-0.962em, 1001.23em, 0.454em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.185em; right: 0em;"><span class="mtd" id="mjx-eqn-4"><span class="mrow" id="MathJax-Span-335"><span class="mtext" id="MathJax-Span-336" style="font-family: MathJax_Main;">(4)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.139em; border-left: 0px solid; width: 0px; height: 2.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-4"><mtext>(4)</mtext></mtd><mtd><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo></mtd><mtd><mi>g</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mo>…</mo></mtd></mtr><mtr><mtd><mo>+</mo></mtd><mtd><mi>g</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>n</mi></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mtr></mtable></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-24">\begin{aligned}f(y_1,\dots,y_n;\boldsymbol{x})=h(y_1;\boldsymbol{x})+&g(y_1,y_2)+h(y_2;\boldsymbol{x})+\dots\\ 
+&g(y_{n-1},y_n)+h(y_n;\boldsymbol{x})\end{aligned}\tag{4}</script><br>
这时候<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-417" style="width: 0.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.45em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-418"><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">g</script>实际上就是一个有限的、待训练的参数矩阵而已，而单标签的打分函数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-420" style="width: 3.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.285em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1003.22em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-423" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-424"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-426" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">h(y_i;\boldsymbol{x})</script>我们可以通过RNN或者CNN来建模。因此，该模型是可以建立的，其中概率分布变为<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-5&quot;&gt;&lt;mtext&gt;(5)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-430" style="width: 100%; display: inline-block; min-width: 34.688em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 34.688em;"><span style="position: absolute; clip: rect(2.062em, 1030.25em, 5.409em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-431"><span class="mtable" id="MathJax-Span-432" style="min-width: 34.688em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 34.688em;"><span style="display: inline-block; position: absolute; width: 30.505em; height: 0px; clip: rect(-1.927em, 1030.25em, 1.419em, -999.997em); top: 0em; left: 50%; margin-left: -15.248em;"><span style="position: absolute; clip: rect(2.062em, 1030.25em, 5.409em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 30.505em; height: 0px;"><span style="position: absolute; clip: rect(2.062em, 1030.25em, 5.409em, -999.997em); top: -3.986em; left: 50%; margin-left: -15.248em;"><span class="mtd" id="MathJax-Span-436"><span class="mrow" id="MathJax-Span-437"><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-440"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-442" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-444" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-446" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-448" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-453" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-454" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mfrac" id="MathJax-Span-455" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px; margin-right: 0.132em; margin-left: 0.132em;"><span style="position: absolute; clip: rect(1.355em, 1000.45em, 2.384em, -999.997em); top: -2.893em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-456" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.226em, 1002.13em, 2.642em, -999.997em); top: -1.412em; left: 50%; margin-left: -1.091em;"><span class="mrow" id="MathJax-Span-457"><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(0.84em, 1002.32em, 1.29em, -999.997em); top: -1.284em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.32em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.097em;"></span></span></span></span><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Main;">exp</span><span class="mo" id="MathJax-Span-463"></span><span class="mrow" id="MathJax-Span-464"><span class="mo" id="MathJax-Span-465" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-467" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-468"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-469" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-470" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-471" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="munderover" id="MathJax-Span-475" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.419em; height: 0px;"><span style="position: absolute; clip: rect(2.062em, 1001.36em, 3.864em, -999.997em); top: -3.214em; left: 0em;"><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.221em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1001.23em, 2.513em, -999.997em); top: -1.091em; left: 0.068em;"><span class="texatom" id="MathJax-Span-477"><span class="mrow" id="MathJax-Span-478"><span class="mi" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-481" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.419em, 1001.29em, 2.449em, -999.997em); top: -3.343em; left: 0.003em;"><span class="texatom" id="MathJax-Span-482"><span class="mrow" id="MathJax-Span-483"><span class="mi" id="MathJax-Span-484" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-485" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-487" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-488"><span class="mo" id="MathJax-Span-489" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-491" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-492"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-494" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-496" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-498"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-501" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-504" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">h</span><span class="mo" id="MathJax-Span-506" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-507"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-509"><span class="mrow" id="MathJax-Span-510"><span class="mi" id="MathJax-Span-511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-512" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-513" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-514" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-516" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-517" style=""><span class="mrow" id="MathJax-Span-518"><span class="mo" id="MathJax-Span-519" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span><span class="mo" id="MathJax-Span-520" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.29em; height: 0px; clip: rect(-0.962em, 1001.23em, 0.454em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.185em; right: 0em;"><span class="mtd" id="mjx-eqn-5"><span class="mrow" id="MathJax-Span-434"><span class="mtext" id="MathJax-Span-435" style="font-family: MathJax_Main;">(5)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.425em; border-left: 0px solid; width: 0px; height: 3.504em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-5"><mtext>(5)</mtext></mtd><mtd><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><mi>g</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>,</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow><mo>)</mo></mrow></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">P(y_1,\dots,y_n|\boldsymbol{x})=\frac{1}{Z(\boldsymbol{x})}\exp\left(h(y_1;\boldsymbol{x})+\sum_{k=1}^{n-1}\Big[g(y_k,y_{k+1})+h(y_{k+1};\boldsymbol{x})\Big]\right)\tag{5}</script><br>
这就是线性链CRF的概念。</p><h3 id="归一化因子">归一化因子<a href="https://kexue.fm/archives/5542#%E5%BD%92%E4%B8%80%E5%8C%96%E5%9B%A0%E5%AD%90"> #</a></h3><p>为了训练CRF模型，我们用最大似然方法，也就是用<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-6&quot;&gt;&lt;mtext&gt;(6)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-521" style="width: 100%; display: inline-block; min-width: 13.131em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 13.131em;"><span style="position: absolute; clip: rect(3.028em, 1008.88em, 4.443em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-522"><span class="mtable" id="MathJax-Span-523" style="min-width: 13.131em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.131em;"><span style="display: inline-block; position: absolute; width: 8.948em; height: 0px; clip: rect(-0.962em, 1008.88em, 0.454em, -999.997em); top: 0em; left: 50%; margin-left: -4.437em;"><span style="position: absolute; clip: rect(3.092em, 1008.88em, 4.443em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.948em; height: 0px;"><span style="position: absolute; clip: rect(1.226em, 1008.88em, 2.642em, -999.997em); top: -2.185em; left: 50%; margin-left: -4.437em;"><span class="mtd" id="MathJax-Span-527"><span class="mrow" id="MathJax-Span-528"><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Main; padding-left: 0.196em;">log</span><span class="mo" id="MathJax-Span-531"></span><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mo" id="MathJax-Span-533" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-534"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-539" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-540" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-543"><span class="mrow" id="MathJax-Span-544"><span class="mo" id="MathJax-Span-545" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.29em; height: 0px; clip: rect(-0.898em, 1001.23em, 0.454em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.185em; right: 0em;"><span class="mtd" id="mjx-eqn-6"><span class="mrow" id="MathJax-Span-525"><span class="mtext" id="MathJax-Span-526" style="font-family: MathJax_Main;">(6)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-6"><mtext>(6)</mtext></mtd><mtd><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">-\log P(y_1,\dots,y_n|\boldsymbol{x})\tag{6}</script><br>
作为损失函数，可以算出它等于<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-7&quot;&gt;&lt;mtext&gt;(7)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-548" style="width: 100%; display: inline-block; min-width: 28.317em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 28.317em;"><span style="position: absolute; clip: rect(2.062em, 1024.07em, 5.409em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-549"><span class="mtable" id="MathJax-Span-550" style="min-width: 28.317em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 28.317em;"><span style="display: inline-block; position: absolute; width: 24.134em; height: 0px; clip: rect(-1.927em, 1024.07em, 1.419em, -999.997em); top: 0em; left: 50%; margin-left: -12.03em;"><span style="position: absolute; clip: rect(2.062em, 1024.07em, 5.409em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 24.134em; height: 0px;"><span style="position: absolute; clip: rect(2.062em, 1024.07em, 5.409em, -999.997em); top: -3.986em; left: 50%; margin-left: -12.03em;"><span class="mtd" id="MathJax-Span-554"><span class="mrow" id="MathJax-Span-555"><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Main;">−</span><span class="mrow" id="MathJax-Span-557" style="padding-left: 0.196em;"><span class="mo" id="MathJax-Span-558" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-561"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-563" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="munderover" id="MathJax-Span-568" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.419em; height: 0px;"><span style="position: absolute; clip: rect(2.062em, 1001.36em, 3.864em, -999.997em); top: -3.214em; left: 0em;"><span class="mo" id="MathJax-Span-569" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.221em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1001.23em, 2.513em, -999.997em); top: -1.091em; left: 0.068em;"><span class="texatom" id="MathJax-Span-570"><span class="mrow" id="MathJax-Span-571"><span class="mi" id="MathJax-Span-572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-574" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.419em, 1001.29em, 2.449em, -999.997em); top: -3.343em; left: 0.003em;"><span class="texatom" id="MathJax-Span-575"><span class="mrow" id="MathJax-Span-576"><span class="mi" id="MathJax-Span-577" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-578" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-579" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-580" style="padding-left: 0.196em;"><span class="mrow" id="MathJax-Span-581"><span class="mo" id="MathJax-Span-582" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-585"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-587" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-588" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-589" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-590" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-591"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">h</span><span class="mo" id="MathJax-Span-599" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-600"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-602"><span class="mrow" id="MathJax-Span-603"><span class="mi" id="MathJax-Span-604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-605" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-606" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-607" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-608" style="font-family: MathJax_Math-bold-italic; padding-left: 0.196em;">x</span><span class="mo" id="MathJax-Span-609" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-610" style=""><span class="mrow" id="MathJax-Span-611"><span class="mo" id="MathJax-Span-612" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span><span class="mo" id="MathJax-Span-613" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="mo" id="MathJax-Span-614" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Main; padding-left: 0.196em;">log</span><span class="mo" id="MathJax-Span-616"></span><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-618" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-620" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.29em; height: 0px; clip: rect(-0.962em, 1001.23em, 0.454em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.185em; right: 0em;"><span class="mtd" id="mjx-eqn-7"><span class="mrow" id="MathJax-Span-552"><span class="mtext" id="MathJax-Span-553" style="font-family: MathJax_Main;">(7)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.425em; border-left: 0px solid; width: 0px; height: 3.504em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-7"><mtext>(7)</mtext></mtd><mtd><mo>−</mo><mrow><mo>(</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><mi>g</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>,</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow><mo>)</mo></mrow><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>Z</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-29">-\left(h(y_1;\boldsymbol{x})+\sum_{k=1}^{n-1}\Big[g(y_k,y_{k+1})+h(y_{k+1};\boldsymbol{x})\Big]\right)+\log Z(\boldsymbol{x})\tag{7}</script><br>
其中第一项是原来概率式的<strong>分子</strong>的对数，它目标的序列的打分，虽然它看上去挺迂回的，但是并不难计算。真正的难度在于<strong>分母</strong>的对数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-621" style="width: 3.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.607em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1003.54em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-622"><span class="mi" id="MathJax-Span-623" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-624"></span><span class="mi" id="MathJax-Span-625" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-628" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mi>Z</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-30">\log Z(\boldsymbol{x})</script>这一项。</p><p>归一化因子，在物理上也叫配分函数，在这里它需要我们对所有可能的路径的打分进行指数求和，而我们前面已经说到，这样的路径数是指数量级的（<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-629" style="width: 1.097em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.97em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-630"><span class="msubsup" id="MathJax-Span-631"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-632" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.571em; left: 0.518em;"><span class="mi" id="MathJax-Span-633" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>k</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-31">k^n</script>），因此直接来算几乎是不可能的。</p><p>事实上，<u>归一化因子难算，几乎是所有概率图模型的公共难题</u>。幸运的是，在CRF模型中，由于我们只考虑了临近标签的联系（马尔可夫假设），因此我们可以递归地算出归一化因子，这使得原来是指数级的计算量降低为线性级别。具体来说，我们将计算到时刻<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-634" style="width: 0.454em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.389em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.355em, 1000.39em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-635"><span class="mi" id="MathJax-Span-636" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">t</script>的归一化因子记为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-637" style="width: 1.226em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1001.1em, 2.513em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-638"><span class="msubsup" id="MathJax-Span-639"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-640" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.711em;"><span class="mi" id="MathJax-Span-641" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>Z</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">Z_t</script>，并将它分为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-642" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.518em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-643"><span class="mi" id="MathJax-Span-644" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">k</script>个部分<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-8&quot;&gt;&lt;mtext&gt;(8)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-645" style="width: 100%; display: inline-block; min-width: 16.412em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 16.412em;"><span style="position: absolute; clip: rect(2.899em, 1012.23em, 4.636em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-646"><span class="mtable" id="MathJax-Span-647" style="min-width: 16.412em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.412em;"><span style="display: inline-block; position: absolute; width: 12.23em; height: 0px; clip: rect(-1.091em, 1012.23em, 0.647em, -999.997em); top: 0em; left: 50%; margin-left: -6.11em;"><span style="position: absolute; clip: rect(2.899em, 1012.23em, 4.636em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.23em; height: 0px;"><span style="position: absolute; clip: rect(0.968em, 1012.23em, 2.642em, -999.997em); top: -2.056em; left: 50%; margin-left: -6.11em;"><span class="mtd" id="MathJax-Span-651"><span class="mrow" id="MathJax-Span-652"><span class="msubsup" id="MathJax-Span-653"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-654" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.711em;"><span class="mi" id="MathJax-Span-655" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-656" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-657" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-659"><span class="mrow" id="MathJax-Span-660"><span class="mo" id="MathJax-Span-661" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-662" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-663" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-664" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-665" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="msubsup" id="MathJax-Span-666" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-667" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-668"><span class="mrow" id="MathJax-Span-669"><span class="mo" id="MathJax-Span-670" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-671" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-672" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-674" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Main; padding-left: 0.196em;">⋯</span><span class="mo" id="MathJax-Span-676" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="msubsup" id="MathJax-Span-677" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-678" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-679"><span class="mrow" id="MathJax-Span-680"><span class="mo" id="MathJax-Span-681" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-682" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-683" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-684" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.29em; height: 0px; clip: rect(-0.833em, 1001.23em, 0.582em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.056em; right: 0em;"><span class="mtd" id="mjx-eqn-8"><span class="mrow" id="MathJax-Span-649"><span class="mtext" id="MathJax-Span-650" style="font-family: MathJax_Main;">(8)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-8"><mtext>(8)</mtext></mtd><mtd><msub><mi>Z</mi><mi>t</mi></msub><mo>=</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">Z_t = Z^{(1)}_t + Z^{(2)}_t + \dots + Z^{(k)}_t\tag{8}</script><br>
其中<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-685" style="width: 6.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.795em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.968em, 1005.79em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-686"><span class="msubsup" id="MathJax-Span-687"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-688" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-689"><span class="mrow" id="MathJax-Span-690"><span class="mo" id="MathJax-Span-691" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-692" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-693" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-694" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-695" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-696" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-698" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-699" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-700"><span class="mrow" id="MathJax-Span-701"><span class="mo" id="MathJax-Span-702" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-703" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-704" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-705" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>,</mo><mo>…</mo><mo>,</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-36">Z^{(1)}_t,\dots,Z^{(k)}_t</script>分别是截止到当前时刻<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-706" style="width: 0.454em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.389em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.355em, 1000.39em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-707"><span class="mi" id="MathJax-Span-708" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">t</script>中、以标签<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-709" style="width: 3.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.221em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1003.22em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-710"><span class="mn" id="MathJax-Span-711" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-713" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-714" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="mi" id="MathJax-Span-715" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">1,\dots,k</script>为终点的所有路径的得分指数和。那么，我们可以递归地计算<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-9&quot;&gt;&lt;mtext&gt;(9)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;22&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mo&gt;&amp;#x22EE;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-716" style="width: 100%; display: inline-block; min-width: 27.545em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 27.545em;"><span style="position: absolute; clip: rect(4.508em, 1023.11em, 12.68em, -999.997em); top: -8.813em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-717"><span class="mtable" id="MathJax-Span-718" style="min-width: 27.545em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 27.545em;"><span style="display: inline-block; position: absolute; width: 23.362em; height: 0px; clip: rect(-4.308em, 1023.11em, 3.864em, -999.997em); top: 0em; left: 50%; margin-left: -11.708em;"><span style="position: absolute; clip: rect(4.508em, 1023.11em, 12.68em, -999.997em); top: -8.813em; left: 0em;"><span style="display: inline-block; position: relative; width: 23.362em; height: 0px;"><span style="position: absolute; clip: rect(4.508em, 1023.11em, 12.68em, -999.997em); top: -8.813em; left: 50%; margin-left: -11.708em;"><span class="mtd" id="MathJax-Span-722"><span class="mrow" id="MathJax-Span-723"><span class="mtable" id="MathJax-Span-724" style="padding-right: 0.196em; padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 22.976em; height: 0px;"><span style="position: absolute; clip: rect(4.186em, 1002.96em, 11.972em, -999.997em); top: -8.427em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.028em; height: 0px;"><span style="position: absolute; clip: rect(0.968em, 1002.96em, 2.77em, -999.997em); top: -5.209em; right: 0em;"><span class="mtd" id="MathJax-Span-725"><span class="mrow" id="MathJax-Span-726"><span class="msubsup" id="MathJax-Span-727"><span style="display: inline-block; position: relative; width: 1.998em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-729"><span class="mrow" id="MathJax-Span-730"><span class="mo" id="MathJax-Span-731" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-732" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-733" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1001.23em, 2.449em, -999.997em); top: -1.863em; left: 0.711em;"><span class="texatom" id="MathJax-Span-734"><span class="mrow" id="MathJax-Span-735"><span class="mi" id="MathJax-Span-736" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-737" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-738" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-739" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(0.968em, 1002.96em, 2.77em, -999.997em); top: -3.086em; right: 0em;"><span class="mtd" id="MathJax-Span-807"><span class="mrow" id="MathJax-Span-808"><span class="msubsup" id="MathJax-Span-809"><span style="display: inline-block; position: relative; width: 1.998em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-810" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-811"><span class="mrow" id="MathJax-Span-812"><span class="mo" id="MathJax-Span-813" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-814" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-815" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1001.23em, 2.449em, -999.997em); top: -1.863em; left: 0.711em;"><span class="texatom" id="MathJax-Span-816"><span class="mrow" id="MathJax-Span-817"><span class="mi" id="MathJax-Span-818" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-819" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-820" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-821" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(3.8em, 1000em, 4.186em, -999.997em); top: -2.635em; right: 0em;"><span class="mtd" id="MathJax-Span-889"><span class="mrow" id="MathJax-Span-890"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(0.968em, 1002.96em, 2.77em, -999.997em); top: 0.84em; right: 0em;"><span class="mtd" id="MathJax-Span-897"><span class="mrow" id="MathJax-Span-898"><span class="msubsup" id="MathJax-Span-899"><span style="display: inline-block; position: relative; width: 1.998em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-900" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-901"><span class="mrow" id="MathJax-Span-902"><span class="mo" id="MathJax-Span-903" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-904" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-905" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1001.23em, 2.449em, -999.997em); top: -1.863em; left: 0.711em;"><span class="texatom" id="MathJax-Span-906"><span class="mrow" id="MathJax-Span-907"><span class="mi" id="MathJax-Span-908" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-909" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-910" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-911" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.433em;"></span></span><span style="position: absolute; clip: rect(4.508em, 1019.89em, 12.68em, -999.997em); top: -8.813em; left: 3.028em;"><span style="display: inline-block; position: relative; width: 19.952em; height: 0px;"><span style="position: absolute; clip: rect(1.869em, 1019.89em, 4.057em, -999.997em); top: -6.239em; left: 0em;"><span class="mtd" id="MathJax-Span-740"><span class="mrow" id="MathJax-Span-741"><span class="mi" id="MathJax-Span-742"></span><span class="texatom" id="MathJax-Span-743"><span class="mrow" id="MathJax-Span-744"><span class="mo" id="MathJax-Span-745" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-746"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-747" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-748"><span class="mrow" id="MathJax-Span-749"><span class="mo" id="MathJax-Span-750" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-751" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-752" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-753" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-754"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-755" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-756"><span class="mrow" id="MathJax-Span-757"><span class="mn" id="MathJax-Span-758" style="font-size: 70.7%; font-family: MathJax_Main;">11</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-759" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="msubsup" id="MathJax-Span-760" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-761" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-762"><span class="mrow" id="MathJax-Span-763"><span class="mo" id="MathJax-Span-764" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-765" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-766" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-767" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-768"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-769" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-770"><span class="mrow" id="MathJax-Span-771"><span class="mn" id="MathJax-Span-772" style="font-size: 70.7%; font-family: MathJax_Main;">21</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-773" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mo" id="MathJax-Span-774" style="font-family: MathJax_Main; padding-left: 0.196em;">⋯</span><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="msubsup" id="MathJax-Span-776" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-778"><span class="mrow" id="MathJax-Span-779"><span class="mo" id="MathJax-Span-780" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-781" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-782" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-783" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-784"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-785" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-786"><span class="mrow" id="MathJax-Span-787"><span class="mi" id="MathJax-Span-788" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mn" id="MathJax-Span-789" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-790"><span class="mrow" id="MathJax-Span-791"><span class="mo" id="MathJax-Span-792" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span class="msubsup" id="MathJax-Span-793"><span style="display: inline-block; position: relative; width: 2.062em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.9em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-794" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.84em;"><span class="texatom" id="MathJax-Span-795"><span class="mrow" id="MathJax-Span-796"><span class="mi" id="MathJax-Span-797" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-798" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-799" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-801" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-802"><span class="mrow" id="MathJax-Span-803"><span class="mo" id="MathJax-Span-804" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-805" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.221em;"></span></span><span style="position: absolute; clip: rect(1.869em, 1019.89em, 4.057em, -999.997em); top: -4.115em; left: 0em;"><span class="mtd" id="MathJax-Span-822"><span class="mrow" id="MathJax-Span-823"><span class="mi" id="MathJax-Span-824"></span><span class="texatom" id="MathJax-Span-825"><span class="mrow" id="MathJax-Span-826"><span class="mo" id="MathJax-Span-827" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-828"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-829" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-830"><span class="mrow" id="MathJax-Span-831"><span class="mo" id="MathJax-Span-832" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-833" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-834" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-835" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-836"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-838"><span class="mrow" id="MathJax-Span-839"><span class="mn" id="MathJax-Span-840" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-841" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="msubsup" id="MathJax-Span-842" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-844"><span class="mrow" id="MathJax-Span-845"><span class="mo" id="MathJax-Span-846" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-847" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-848" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-849" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-850"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-852"><span class="mrow" id="MathJax-Span-853"><span class="mn" id="MathJax-Span-854" style="font-size: 70.7%; font-family: MathJax_Main;">22</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-855" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mo" id="MathJax-Span-856" style="font-family: MathJax_Main; padding-left: 0.196em;">⋯</span><span class="mo" id="MathJax-Span-857" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="msubsup" id="MathJax-Span-858" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-859" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-860"><span class="mrow" id="MathJax-Span-861"><span class="mo" id="MathJax-Span-862" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-863" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-864" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-865" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-866"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-868"><span class="mrow" id="MathJax-Span-869"><span class="mi" id="MathJax-Span-870" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mn" id="MathJax-Span-871" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-872"><span class="mrow" id="MathJax-Span-873"><span class="mo" id="MathJax-Span-874" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span class="msubsup" id="MathJax-Span-875"><span style="display: inline-block; position: relative; width: 2.062em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.9em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-876" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.84em;"><span class="texatom" id="MathJax-Span-877"><span class="mrow" id="MathJax-Span-878"><span class="mi" id="MathJax-Span-879" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-880" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-881" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-882" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-883" style="font-family: MathJax_Main;">2</span><span class="texatom" id="MathJax-Span-884"><span class="mrow" id="MathJax-Span-885"><span class="mo" id="MathJax-Span-886" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-888" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.221em;"></span></span><span style="position: absolute; clip: rect(0.711em, 1004.19em, 2.384em, -999.997em); top: -0.833em; left: 0em;"><span class="mtd" id="MathJax-Span-891"><span class="mrow" id="MathJax-Span-892"><span class="mi" id="MathJax-Span-893"></span><span class="mspace" id="MathJax-Span-894" style="height: 0em; vertical-align: 0em; width: 1.998em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-895" style="height: 0em; vertical-align: 0em; width: 1.998em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-896" style="font-family: MathJax_Main;">⋮</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.869em, 1019.89em, 4.057em, -999.997em); top: -0.19em; left: 0em;"><span class="mtd" id="MathJax-Span-912"><span class="mrow" id="MathJax-Span-913"><span class="mi" id="MathJax-Span-914"></span><span class="texatom" id="MathJax-Span-915"><span class="mrow" id="MathJax-Span-916"><span class="mo" id="MathJax-Span-917" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-918"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="mo" id="MathJax-Span-922" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-923" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-924" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-925" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-926"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-927" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-928"><span class="mrow" id="MathJax-Span-929"><span class="mn" id="MathJax-Span-930" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mi" id="MathJax-Span-931" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-932" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="msubsup" id="MathJax-Span-933" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-935"><span class="mrow" id="MathJax-Span-936"><span class="mo" id="MathJax-Span-937" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-938" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-939" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-940" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-941"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-942" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-943"><span class="mrow" id="MathJax-Span-944"><span class="mn" id="MathJax-Span-945" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-946" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-947" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mo" id="MathJax-Span-948" style="font-family: MathJax_Main; padding-left: 0.196em;">⋯</span><span class="mo" id="MathJax-Span-949" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="msubsup" id="MathJax-Span-950" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-951" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-952"><span class="mrow" id="MathJax-Span-953"><span class="mo" id="MathJax-Span-954" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-955" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-956" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-957" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-958"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-959" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-960"><span class="mrow" id="MathJax-Span-961"><span class="mi" id="MathJax-Span-962" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mi" id="MathJax-Span-963" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-964"><span class="mrow" id="MathJax-Span-965"><span class="mo" id="MathJax-Span-966" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span class="msubsup" id="MathJax-Span-967"><span style="display: inline-block; position: relative; width: 2.062em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.9em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-968" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.84em;"><span class="texatom" id="MathJax-Span-969"><span class="mrow" id="MathJax-Span-970"><span class="mi" id="MathJax-Span-971" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-972" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-973" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-974" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-975" style="font-family: MathJax_Math-italic;">k</span><span class="texatom" id="MathJax-Span-976"><span class="mrow" id="MathJax-Span-977"><span class="mo" id="MathJax-Span-978" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-979" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-980" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.221em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.819em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 8.819em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.819em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.29em; height: 0px; clip: rect(-0.962em, 1001.23em, 0.454em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.185em; right: 0em;"><span class="mtd" id="mjx-eqn-9"><span class="mrow" id="MathJax-Span-720"><span class="mtext" id="MathJax-Span-721" style="font-family: MathJax_Main;">(9)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 8.819em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.139em; border-left: 0px solid; width: 0px; height: 8.789em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-9"><mtext>(9)</mtext></mtd><mtd><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msubsup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msub><mo>+</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mn>21</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">)</mo></mrow><msub><mi>H</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msubsup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msub><mo>+</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mn>22</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mn>2</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">)</mo></mrow><msub><mi>H</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mspace width="2em"></mspace><mspace width="2em"></mspace><mo>⋮</mo></mtd></mtr><mtr><mtd><msubsup><mi>Z</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo></mtd><mtd><mi></mi><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>k</mi></mrow></msub><mo>+</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>k</mi></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mi>k</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">)</mo></mrow><msub><mi>H</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mtr></mtable></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">\begin{aligned}Z^{(1)}_{t+1} = &\Big(Z^{(1)}_t G_{11} + Z^{(2)}_t G_{21} + \dots + Z^{(k)}_t G_{k1} \Big) H_{t+1}(1|\boldsymbol{x})\\ 
Z^{(2)}_{t+1} = &\Big(Z^{(1)}_t G_{12} + Z^{(2)}_t G_{22} + \dots + Z^{(k)}_t G_{k2} \Big) H_{t+1}(2|\boldsymbol{x})\\ 
&\qquad\qquad\vdots\\ 
Z^{(k)}_{t+1} =& \Big(Z^{(1)}_t G_{1k} + Z^{(2)}_t G_{2k} + \dots + Z^{(k)}_t G_{kk} \Big) H_{t+1}(k|\boldsymbol{x}) 
\end{aligned}\tag{9}</script><br>
它可以简单写为矩阵形式<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-10&quot;&gt;&lt;mtext&gt;(10)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;G&lt;/mi&gt;&lt;mo&gt;&amp;#x2297;&lt;/mo&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-981" style="width: 100%; display: inline-block; min-width: 15.898em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 15.898em;"><span style="position: absolute; clip: rect(3.028em, 1010.62em, 4.443em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-982"><span class="mtable" id="MathJax-Span-983" style="min-width: 15.898em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.898em;"><span style="display: inline-block; position: absolute; width: 10.685em; height: 0px; clip: rect(-0.962em, 1010.62em, 0.454em, -999.997em); top: 0em; left: 50%; margin-left: -5.338em;"><span style="position: absolute; clip: rect(3.092em, 1010.62em, 4.443em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.685em; height: 0px;"><span style="position: absolute; clip: rect(1.226em, 1010.62em, 2.642em, -999.997em); top: -2.185em; left: 50%; margin-left: -5.338em;"><span class="mtd" id="MathJax-Span-987"><span class="mrow" id="MathJax-Span-988"><span class="msubsup" id="MathJax-Span-989"><span style="display: inline-block; position: relative; width: 1.998em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-990" style="font-family: MathJax_Math-bold-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-991"><span class="mrow" id="MathJax-Span-992"><span class="mi" id="MathJax-Span-993" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-994" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-995" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-996" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-997" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-998" style="font-family: MathJax_Math-bold-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-999"><span class="mrow" id="MathJax-Span-1000"><span class="mi" id="MathJax-Span-1001" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mi" id="MathJax-Span-1002" style="font-family: MathJax_Math-bold-italic;">G</span><span class="mo" id="MathJax-Span-1003" style="font-family: MathJax_Main; padding-left: 0.196em;">⊗</span><span class="mi" id="MathJax-Span-1004" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-1005" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1006"><span style="display: inline-block; position: relative; width: 1.741em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1007" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-1008"><span class="mrow" id="MathJax-Span-1009"><span class="mi" id="MathJax-Span-1010" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1011" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1012" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1013"><span class="mrow" id="MathJax-Span-1014"><span class="mo" id="MathJax-Span-1015" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1016" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1017" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.805em; height: 0px; clip: rect(-0.898em, 1001.74em, 0.454em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.74em, 2.642em, -999.997em); top: -2.185em; right: 0em;"><span class="mtd" id="mjx-eqn-10"><span class="mrow" id="MathJax-Span-985"><span class="mtext" id="MathJax-Span-986" style="font-family: MathJax_Main;">(10)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-10"><mtext>(10)</mtext></mtd><mtd><msub><mi mathvariant="bold-italic">Z</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant="bold-italic">Z</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mi mathvariant="bold-italic">G</mi><mo>⊗</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">\boldsymbol{Z}_{t+1} = \boldsymbol{Z}_{t} \boldsymbol{G}\otimes H(y_{t+1}|\boldsymbol{x})\tag{10}</script><br>
其中<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1018" style="width: 10.171em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.141em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.869em, 1008.95em, 4.057em, -999.997em); top: -3.214em; left: 0em;"><span class="mrow" id="MathJax-Span-1019"><span class="msubsup" id="MathJax-Span-1020"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1021" style="font-family: MathJax_Math-bold-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-1022"><span class="mrow" id="MathJax-Span-1023"><span class="mi" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-1025" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="texatom" id="MathJax-Span-1026" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-1027"><span class="mo" id="MathJax-Span-1028" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-1029"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1030" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-1031"><span class="mrow" id="MathJax-Span-1032"><span class="mo" id="MathJax-Span-1033" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1034" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1035" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-1036" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-1037" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1038" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-1039" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-1040" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1041" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.483em, 1000.97em, 2.577em, -999.997em); top: -2.699em; left: 0.84em;"><span class="texatom" id="MathJax-Span-1042"><span class="mrow" id="MathJax-Span-1043"><span class="mo" id="MathJax-Span-1044" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1045" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1046" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; clip: rect(1.548em, 1000.33em, 2.384em, -999.997em); top: -1.927em; left: 0.711em;"><span class="mi" id="MathJax-Span-1047" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1048"><span class="mrow" id="MathJax-Span-1049"><span class="mo" id="MathJax-Span-1050" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.782em; border-left: 0px solid; width: 0px; height: 2.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="bold-italic">Z</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>,</mo><mo>…</mo><mo>,</mo><msubsup><mi>Z</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-41">\boldsymbol{Z}_{t}=\Big[Z^{(1)}_t,\dots,Z^{(k)}_t\Big]</script>；而<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1051" style="width: 1.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.84em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1052"><span class="mi" id="MathJax-Span-1053" style="font-family: MathJax_Math-bold-italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">G</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">\boldsymbol{G}</script>是对矩阵<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1054" style="width: 0.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.45em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1055"><span class="mi" id="MathJax-Span-1056" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">g</script>各个元素取指数后的矩阵（前面已经说过，最简单的情况下，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1057" style="width: 0.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.45em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1058"><span class="mi" id="MathJax-Span-1059" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">g</script>只是一个矩阵，代表某个标签到另一个标签的分数），即<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;G&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1060" style="width: 4.636em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.186em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1004.19em, 2.706em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1061"><span class="msubsup" id="MathJax-Span-1062"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.84em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1063" style="font-family: MathJax_Math-bold-italic;">G</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.904em;"><span class="texatom" id="MathJax-Span-1064"><span class="mrow" id="MathJax-Span-1065"><span class="mi" id="MathJax-Span-1066" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1067" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-1068" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-1069" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.419em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.39em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1070" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.454em;"><span class="texatom" id="MathJax-Span-1071"><span class="mrow" id="MathJax-Span-1072"><span class="msubsup" id="MathJax-Span-1073"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(1.676em, 1000.39em, 2.513em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1074" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -1.992em; left: 0.389em;"><span class="texatom" id="MathJax-Span-1075"><span class="mrow" id="MathJax-Span-1076"><span class="mi" id="MathJax-Span-1077" style="font-size: 51.5%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1078" style="font-size: 51.5%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="bold-italic">G</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-45">\boldsymbol{G}_{ij}=e^{g_{ij}}</script>；而<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1079" style="width: 4.894em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.379em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1004.32em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1080"><span class="mi" id="MathJax-Span-1081" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-1082" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1083"><span style="display: inline-block; position: relative; width: 1.741em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1084" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-1085"><span class="mrow" id="MathJax-Span-1086"><span class="mi" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1089" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1090"><span class="mrow" id="MathJax-Span-1091"><span class="mo" id="MathJax-Span-1092" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1093" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1094" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-46">H(y_{t+1}|\boldsymbol{x})</script>是编码模型<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1095" style="width: 4.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.993em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1003.93em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1096"><span class="mi" id="MathJax-Span-1097" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-1098" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1099"><span style="display: inline-block; position: relative; width: 1.741em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1100" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-1101"><span class="mrow" id="MathJax-Span-1102"><span class="mi" id="MathJax-Span-1103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1104" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1105" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1106"><span class="mrow" id="MathJax-Span-1107"><span class="mo" id="MathJax-Span-1108" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1109" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1110" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-47">h(y_{t+1}|\boldsymbol{x})</script>（RNN、CNN等）对位置<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1111" style="width: 2.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.934em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.355em, 1001.87em, 2.449em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1112"><span class="mi" id="MathJax-Span-1113" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1114" style="font-family: MathJax_Main; padding-left: 0.196em;">+</span><span class="mn" id="MathJax-Span-1115" style="font-family: MathJax_Main; padding-left: 0.196em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.139em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-48">t+1</script>的各个标签的打分的指数，即<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1116" style="width: 10.299em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.27em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.097em, 1009.27em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1117"><span class="mi" id="MathJax-Span-1118" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-1119" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1120"><span style="display: inline-block; position: relative; width: 1.741em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1121" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="texatom" id="MathJax-Span-1122"><span class="mrow" id="MathJax-Span-1123"><span class="mi" id="MathJax-Span-1124" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1125" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1126" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1127"><span class="mrow" id="MathJax-Span-1128"><span class="mo" id="MathJax-Span-1129" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1130" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1131" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1132" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="msubsup" id="MathJax-Span-1133" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.607em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.39em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1134" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.571em; left: 0.454em;"><span class="texatom" id="MathJax-Span-1135"><span class="mrow" id="MathJax-Span-1136"><span class="mi" id="MathJax-Span-1137" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-1138" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1139"><span style="display: inline-block; position: relative; width: 1.483em; height: 0px;"><span style="position: absolute; clip: rect(1.676em, 1000.39em, 2.513em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1140" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -1.992em; left: 0.389em;"><span class="texatom" id="MathJax-Span-1141"><span class="mrow" id="MathJax-Span-1142"><span class="mi" id="MathJax-Span-1143" style="font-size: 51.5%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1144" style="font-size: 51.5%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1145" style="font-size: 51.5%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1146"><span class="mrow" id="MathJax-Span-1147"><span class="mo" id="MathJax-Span-1148" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1149" style="font-size: 70.7%; font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1150" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-49">H(y_{t+1}|\boldsymbol{x})=e^{h(y_{t+1}|\boldsymbol{x})}</script>，也是一个向量。式<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1151" style="width: 1.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1001.74em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1152"><span class="mo" id="MathJax-Span-1153" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1154" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-1155" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-50">(10)</script>中，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;G&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1156" style="width: 2.255em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.998em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1001.93em, 2.513em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1157"><span class="msubsup" id="MathJax-Span-1158"><span style="display: inline-block; position: relative; width: 1.097em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1159" style="font-family: MathJax_Math-bold-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.775em;"><span class="texatom" id="MathJax-Span-1160"><span class="mrow" id="MathJax-Span-1161"><span class="mi" id="MathJax-Span-1162" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mi" id="MathJax-Span-1163" style="font-family: MathJax_Math-bold-italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="bold-italic">Z</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mi mathvariant="bold-italic">G</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">\boldsymbol{Z}_{t} \boldsymbol{G}</script>这一步是矩阵乘法，得到一个向量，而<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2297;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1164" style="width: 0.904em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.419em, 1000.71em, 2.449em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1165"><span class="mo" id="MathJax-Span-1166" style="font-family: MathJax_Main;">⊗</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.139em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>⊗</mo></math></span></span><script type="math/tex" id="MathJax-Element-52">\otimes</script>是两个向量的逐位对应相乘。</p><p></p><div class="pic-container"><div class="typecho-caption aligncenter" style="max-width: 400px"><div style="margin: 5px"><a href="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/1751224614.png" title="点击查看原图" target="_blank"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/1751224614.png" style="max-width: 100%" alt="归一化因子的递归计算图示。从t到t+1时刻的计算，包括转移概率和j+1节点本身的概率"></a></div><p class="typecho-caption-text">归一化因子的递归计算图示。从t到t+1时刻的计算，包括转移概率和j+1节点本身的概率</p></div></div><p></p><p>如果不熟悉的读者，可能一下子比较难接受<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1167" style="width: 1.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1001.74em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1168"><span class="mo" id="MathJax-Span-1169" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1170" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-1171" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">(10)</script>式。读者可以把<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1172" style="width: 8.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.047em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.355em, 1007.98em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1173"><span class="mi" id="MathJax-Span-1174" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1175" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mn" id="MathJax-Span-1176" style="font-family: MathJax_Main; padding-left: 0.261em;">1</span><span class="mo" id="MathJax-Span-1177" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1178" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">n</span><span class="mo" id="MathJax-Span-1179" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mn" id="MathJax-Span-1180" style="font-family: MathJax_Main; padding-left: 0.261em;">2</span><span class="mo" id="MathJax-Span-1181" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1182" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">n</span><span class="mo" id="MathJax-Span-1183" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mn" id="MathJax-Span-1184" style="font-family: MathJax_Main; padding-left: 0.261em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>n</mi><mo>=</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-54">n=1,n=2,n=3</script>时的归一化因子写出来，试着找它们的递归关系，慢慢地就可以理解<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1185" style="width: 1.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1001.74em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1186"><span class="mo" id="MathJax-Span-1187" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1188" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-1189" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-55">(10)</script>式了。</p><h3 id="动态规划">动态规划<a href="https://kexue.fm/archives/5542#%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92"> #</a></h3><p>写出损失函数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1190" style="width: 9.977em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.948em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1008.88em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1191"><span class="mo" id="MathJax-Span-1192" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1193" style="font-family: MathJax_Main; padding-left: 0.196em;">log</span><span class="mo" id="MathJax-Span-1194"></span><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mo" id="MathJax-Span-1196" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1197"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1198" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-1199" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-1200" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1201" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-1202" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-1203" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1204" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-1205" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1206"><span class="mrow" id="MathJax-Span-1207"><span class="mo" id="MathJax-Span-1208" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1209" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1210" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56">-\log P(y_1,\dots,y_n|\boldsymbol{x})</script>后，就可以完成模型的训练了，因为目前的深度学习框架都已经带有自动求导的功能，只要我们能写出可导的loss，就可以帮我们完成优化过程了。</p><p>那么剩下的最后一步，就是模型训练完成后，如何根据输入找出最优路径来。跟前面一样，这也是一个从<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1211" style="width: 1.097em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.97em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1212"><span class="msubsup" id="MathJax-Span-1213"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.52em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1214" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.571em; left: 0.518em;"><span class="mi" id="MathJax-Span-1215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>k</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-57">k^n</script>条路径中选最优的问题，而同样地，因为马尔可夫假设的存在，它可以转化为一个动态规划问题，用viterbi算法解决，计算量正比于<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1216" style="width: 0.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.647em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.548em, 1000.65em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1217"><span class="mi" id="MathJax-Span-1218" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">n</script>。</p><p><strong>动态规划在本博客已经出现了多次了，它的递归思想就是：一条最优路径切成两段，那么每一段都是一条（局部）最优路径。在本博客右端的搜索框键入“动态规划”，就可以得到很多相关介绍了，所以不再重复了～</strong></p><h2 id="实现">实现<a href="https://kexue.fm/archives/5542#%E5%AE%9E%E7%8E%B0"> #</a></h2><p>经过调试，基于Keras框架下，笔者得到了一个线性链CRF的简明实现，<strong>这也许是最简短的CRF实现了</strong>。这里分享最终的实现并介绍实现要点。</p><h3 id="实现要点">实现要点<a href="https://kexue.fm/archives/5542#%E5%AE%9E%E7%8E%B0%E8%A6%81%E7%82%B9"> #</a></h3><p>前面我们已经说明了，实现CRF的困难之处是<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1219" style="width: 9.977em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.948em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1008.88em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1220"><span class="mo" id="MathJax-Span-1221" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1222" style="font-family: MathJax_Main; padding-left: 0.196em;">log</span><span class="mo" id="MathJax-Span-1223"></span><span class="mi" id="MathJax-Span-1224" style="font-family: MathJax_Math-italic; padding-left: 0.196em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mo" id="MathJax-Span-1225" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1226"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1227" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mn" id="MathJax-Span-1228" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-1229" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1230" style="font-family: MathJax_Main; padding-left: 0.196em;">…</span><span class="mo" id="MathJax-Span-1231" style="font-family: MathJax_Main; padding-left: 0.196em;">,</span><span class="msubsup" id="MathJax-Span-1232" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.52em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1233" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.518em;"><span class="mi" id="MathJax-Span-1234" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="mo" id="MathJax-Span-1237" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1239" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">-\log P(y_1,\dots,y_n|\boldsymbol{x})</script>的计算，而本质困难是归一化因子部分<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1240" style="width: 2.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.191em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1002.13em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1241"><span class="mi" id="MathJax-Span-1242" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-1243" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1244" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1245" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-60">Z(\boldsymbol{x})</script>的计算，得益于马尔科夫假设，我们得到了递归的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1246" style="width: 1.419em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.29em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1001.23em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1247"><span class="mo" id="MathJax-Span-1248" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1249" style="font-family: MathJax_Main;">9</span><span class="mo" id="MathJax-Span-1250" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>9</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-61">(9)</script>式或<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1251" style="width: 1.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.805em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1001.74em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1252"><span class="mo" id="MathJax-Span-1253" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1254" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-1255" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">(10)</script>式，它们应该已经是一般情况下计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1256" style="width: 2.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.191em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.226em, 1002.13em, 2.642em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1257"><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Math-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-1259" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1260" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-1261" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-63">Z(\boldsymbol{x})</script>的计算了。</p><p>那么怎么在深度学习框架中实现这种递归计算呢？要注意，从计算图的视角看，这是通过递归的方法定义一个图，而且这个图的长度还不固定。这对于pytorch这样的动态图框架应该是不为难的，但是对于tensorflow或者基于tensorflow的Keras就很难操作了（它们是静态图框架）。</p><p>不过，并非没有可能，我们可以<font color="red">用封装好的rnn函数来计算</font>！我们知道，rnn本质上就是在递归计算<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-11&quot;&gt;&lt;mtext&gt;(11)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1262" style="width: 100%; display: inline-block; min-width: 13.002em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 13.002em;"><span style="position: absolute; clip: rect(3.028em, 1007.73em, 4.443em, -999.997em); top: -3.986em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1263"><span class="mtable" id="MathJax-Span-1264" style="min-width: 13.002em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.002em;"><span style="display: inline-block; position: absolute; width: 7.79em; height: 0px; clip: rect(-0.962em, 1007.73em, 0.454em, -999.997em); top: 0em; left: 50%; margin-left: -3.858em;"><span style="position: absolute; clip: rect(3.092em, 1007.73em, 4.443em, -999.997em); top: -3.986em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.79em; height: 0px;"><span style="position: absolute; clip: rect(1.226em, 1007.73em, 2.642em, -999.997em); top: -2.185em; left: 50%; margin-left: -3.858em;"><span class="mtd" id="MathJax-Span-1268"><span class="mrow" id="MathJax-Span-1269"><span class="msubsup" id="MathJax-Span-1270"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.65em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1271" style="font-family: MathJax_Math-bold-italic;">h</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.647em;"><span class="texatom" id="MathJax-Span-1272"><span class="mrow" id="MathJax-Span-1273"><span class="mi" id="MathJax-Span-1274" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1275" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1276" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-1277" style="font-family: MathJax_Main; padding-left: 0.261em;">=</span><span class="mi" id="MathJax-Span-1278" style="font-family: MathJax_Math-italic; padding-left: 0.261em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span><span class="mo" id="MathJax-Span-1279" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1280"><span style="display: inline-block; position: relative; width: 1.869em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000.58em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1281" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.647em;"><span class="texatom" id="MathJax-Span-1282"><span class="mrow" id="MathJax-Span-1283"><span class="mi" id="MathJax-Span-1284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1285" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1286" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-1287" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1288" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(1.29em, 1000.65em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-bold-italic;">h</span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span><span style="position: absolute; top: -2.056em; left: 0.647em;"><span class="texatom" id="MathJax-Span-1290"><span class="mrow" id="MathJax-Span-1291"><span class="mi" id="MathJax-Span-1292" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.805em; height: 0px; clip: rect(-0.898em, 1001.74em, 0.454em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(1.226em, 1001.74em, 2.642em, -999.997em); top: -2.185em; right: 0em;"><span class="mtd" id="mjx-eqn-11"><span class="mrow" id="MathJax-Span-1266"><span class="mtext" id="MathJax-Span-1267" style="font-family: MathJax_Main;">(11)</span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-11"><mtext>(11)</mtext></mtd><mtd><msub><mi mathvariant="bold-italic">h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi mathvariant="bold-italic">h</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-64">\boldsymbol{h}_{t+1} = f(\boldsymbol{x}_{t+1}, \boldsymbol{h}_{t})\tag{11}</script><br>
新版本的tensorflow和Keras都已经允许我们自定义rnn细胞，这就意味着函数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1294" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.58em, 2.577em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1295"><span class="mi" id="MathJax-Span-1296" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.068em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-65">f</script>可以自行定义，而后端自动帮我们完成递归计算。<font color="red">于是我们只需要设计一个rnn，使得我们要计算的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1297" style="width: 0.904em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.29em, 1000.77em, 2.384em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-1298"><span class="mi" id="MathJax-Span-1299" style="font-family: MathJax_Math-bold-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.191em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">Z</mi></math></span></span><script type="math/tex" id="MathJax-Element-66">\boldsymbol{Z}</script>对应于rnn的隐藏向量！</font></p><p>这就是CRF实现中最精致的部分了。</p><p>至于剩下的，是一些细节性的，包括：</p><blockquote><p>1、为了防止溢出，我们通常要取对数，但由于归一化因子是指数求和，所以实际上是<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1300" style="width: 6.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.033em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.875em, 1005.83em, 4.092em, -999.997em); top: -3.254em; left: 0em;"><span class="mrow" id="MathJax-Span-1301"><span class="mi" id="MathJax-Span-1302" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-1303"></span><span class="mrow" id="MathJax-Span-1304"><span class="mo" id="MathJax-Span-1305" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="munderover" id="MathJax-Span-1306"><span style="display: inline-block; position: relative; width: 2.29em; height: 0px;"><span style="position: absolute; clip: rect(1.251em, 1000.97em, 2.706em, -999.997em); top: -2.214em; left: 0em;"><span class="mo" id="MathJax-Span-1307" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span><span style="position: absolute; clip: rect(1.459em, 1000.49em, 2.36em, -999.997em); top: -2.63em; left: 1.043em;"><span class="mi" id="MathJax-Span-1308" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; clip: rect(1.459em, 1001.25em, 2.36em, -999.997em); top: -1.868em; left: 1.043em;"><span class="texatom" id="MathJax-Span-1309"><span class="mrow" id="MathJax-Span-1310"><span class="mi" id="MathJax-Span-1311" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1312" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1313" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1314" style="padding-left: 0.142em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(1.528em, 1000.35em, 2.36em, -999.997em); top: -2.145em; left: 0em;"><span class="mi" id="MathJax-Span-1315" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.419em;"><span class="texatom" id="MathJax-Span-1316"><span class="mrow" id="MathJax-Span-1317"><span class="msubsup" id="MathJax-Span-1318"><span style="display: inline-block; position: relative; width: 0.696em; height: 0px;"><span style="position: absolute; clip: rect(1.667em, 1000.42em, 2.36em, -999.997em); top: -2.145em; left: 0em;"><span class="mi" id="MathJax-Span-1319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; top: -2.006em; left: 0.419em;"><span class="mi" id="MathJax-Span-1320" style="font-size: 55.4%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.023em;"></span></span></span></span><span class="mo" id="MathJax-Span-1321" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.261em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.765em; border-left: 0px solid; width: 0px; height: 2.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mi>i</mi></msub></mrow></msup><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-67">\log\left(\sum_{i=1}^k e^{a_i}\right)</script>这样的格式，它的计算技巧是：<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munderover&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1322" style="width: 28.763em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.922em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.082em, 1025.85em, 5.478em, -999.997em); top: -4.016em; left: 0em;"><span class="mrow" id="MathJax-Span-1323"><span class="mi" id="MathJax-Span-1324" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-1325"></span><span class="mrow" id="MathJax-Span-1326"><span class="mo" id="MathJax-Span-1327" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="munderover" id="MathJax-Span-1328"><span style="display: inline-block; position: relative; width: 1.459em; height: 0px;"><span style="position: absolute; clip: rect(2.082em, 1001.39em, 3.884em, -999.997em); top: -3.254em; left: 0em;"><span class="mo" id="MathJax-Span-1329" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.261em;"></span></span><span style="position: absolute; clip: rect(1.459em, 1001.11em, 2.498em, -999.997em); top: -1.036em; left: 0.142em;"><span class="texatom" id="MathJax-Span-1330"><span class="mrow" id="MathJax-Span-1331"><span class="mi" id="MathJax-Span-1332" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1333" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1334" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; clip: rect(1.32em, 1000.42em, 2.36em, -999.997em); top: -3.323em; left: 0.558em;"><span class="mi" id="MathJax-Span-1335" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1336" style="padding-left: 0.142em;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px;"><span style="position: absolute; clip: rect(1.528em, 1000.35em, 2.36em, -999.997em); top: -2.145em; left: 0em;"><span class="mi" id="MathJax-Span-1337" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; top: -4.432em; left: 0.419em;"><span class="texatom" id="MathJax-Span-1338"><span class="mrow" id="MathJax-Span-1339"><span class="msubsup" id="MathJax-Span-1340"><span style="display: inline-block; position: relative; width: 0.696em; height: 0px;"><span style="position: absolute; clip: rect(1.667em, 1000.42em, 2.36em, -999.997em); top: -2.145em; left: 0em;"><span class="mi" id="MathJax-Span-1341" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; top: -2.006em; left: 0.419em;"><span class="mi" id="MathJax-Span-1342" style="font-size: 55.4%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.023em;"></span></span></span></span><span class="mo" id="MathJax-Span-1343" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="mo" id="MathJax-Span-1344" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mi" id="MathJax-Span-1345" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">A</span><span class="mo" id="MathJax-Span-1346" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-1347" style="font-family: MathJax_Main; padding-left: 0.211em;">log</span><span class="mo" id="MathJax-Span-1348"></span><span class="mrow" id="MathJax-Span-1349"><span class="mo" id="MathJax-Span-1350" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="munderover" id="MathJax-Span-1351"><span style="display: inline-block; position: relative; width: 1.459em; height: 0px;"><span style="position: absolute; clip: rect(2.082em, 1001.39em, 3.884em, -999.997em); top: -3.254em; left: 0em;"><span class="mo" id="MathJax-Span-1352" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.261em;"></span></span><span style="position: absolute; clip: rect(1.459em, 1001.11em, 2.498em, -999.997em); top: -1.036em; left: 0.142em;"><span class="texatom" id="MathJax-Span-1353"><span class="mrow" id="MathJax-Span-1354"><span class="mi" id="MathJax-Span-1355" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1357" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; clip: rect(1.32em, 1000.42em, 2.36em, -999.997em); top: -3.323em; left: 0.558em;"><span class="mi" id="MathJax-Span-1358" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1359" style="padding-left: 0.142em;"><span style="display: inline-block; position: relative; width: 2.29em; height: 0px;"><span style="position: absolute; clip: rect(1.528em, 1000.35em, 2.36em, -999.997em); top: -2.145em; left: 0em;"><span class="mi" id="MathJax-Span-1360" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; top: -2.561em; left: 0.419em;"><span class="texatom" id="MathJax-Span-1361"><span class="mrow" id="MathJax-Span-1362"><span class="msubsup" id="MathJax-Span-1363"><span style="display: inline-block; position: relative; width: 0.696em; height: 0px;"><span style="position: absolute; clip: rect(1.667em, 1000.42em, 2.36em, -999.997em); top: -2.145em; left: 0em;"><span class="mi" id="MathJax-Span-1364" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; top: -2.006em; left: 0.419em;"><span class="mi" id="MathJax-Span-1365" style="font-size: 55.4%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1367" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-1368" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="mo" id="MathJax-Span-1369" style="font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-1370" style="height: 0em; vertical-align: 0em; width: 0.974em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1371" style="font-family: MathJax_Math-italic; padding-left: 0.142em;">A</span><span class="mo" id="MathJax-Span-1372" style="font-family: MathJax_Main; padding-left: 0.281em;">=</span><span class="mo" id="MathJax-Span-1373" style="font-family: MathJax_Main; padding-left: 0.281em;">max</span><span class="mo" id="MathJax-Span-1374" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-1375"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(1.528em, 1000.56em, 2.36em, -999.997em); top: -2.145em; left: 0em;"><span class="mi" id="MathJax-Span-1376" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; top: -2.006em; left: 0.558em;"><span class="mn" id="MathJax-Span-1377" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-1378" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1379" style="font-family: MathJax_Main; padding-left: 0.142em;">…</span><span class="mo" id="MathJax-Span-1380" style="font-family: MathJax_Main; padding-left: 0.142em;">,</span><span class="msubsup" id="MathJax-Span-1381" style="padding-left: 0.142em;"><span style="display: inline-block; position: relative; width: 1.043em; height: 0px;"><span style="position: absolute; clip: rect(1.528em, 1000.56em, 2.36em, -999.997em); top: -2.145em; left: 0em;"><span class="mi" id="MathJax-Span-1382" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span><span style="position: absolute; top: -2.006em; left: 0.558em;"><span class="mi" id="MathJax-Span-1383" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-1384" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 4.023em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.458em; border-left: 0px solid; width: 0px; height: 3.465em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mi>i</mi></msub></mrow></msup><mo>)</mo></mrow><mo>=</mo><mi>A</mi><mo>+</mo><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mi>i</mi></msub><mo>−</mo><mi>A</mi></mrow></msup><mo>)</mo></mrow><mo>,</mo><mspace width="1em"></mspace><mi>A</mi><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo fence="false" stretchy="false">{</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>k</mi></msub><mo fence="false" stretchy="false">}</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-68">\log\left(\sum_{i=1}^k e^{a_i}\right)=A + \log\left(\sum_{i=1}^k e^{a_i-A}\right),\quad A = \max \{a_1,\dots,a_k\}</script><br>
tensorflow和Keras中都已经封装好了对应的logsumexp函数了，直接调用即可；</p><p>2、对于分子（也就是目标序列的得分）的计算技巧，在代码中已经做了注释，主要是通过用“目标序列”点乘“预测序列”来实现取出目标得分；</p><p>3、关于变长输入的padding部分如何进行mask？我觉得在这方面Keras做得并不是很好。为了简单实现这种mask，我的做法是引入多一个标签，比如原来是s、b、m、e四个标签做分词，然后引入第五个标签，比如x，将padding部分的标签都设为x，然后可以直接在CRF损失计算时忽略第五个标签的存在，具体实现请看代码。</p></blockquote><h3 id="代码速览">代码速览<a href="https://kexue.fm/archives/5542#%E4%BB%A3%E7%A0%81%E9%80%9F%E8%A7%88"> #</a></h3><p>纯Keras实现的CRF层，欢迎使用～</p><pre class="line-numbers language-python"><code class=" language-python"><span class="token comment" spellcheck="true"># -*- coding:utf-8 -*-</span>

<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Layer
<span class="token keyword">import</span> keras<span class="token punctuation">.</span>backend <span class="token keyword">as</span> K


<span class="token keyword">class</span> <span class="token class-name">CRF</span><span class="token punctuation">(</span>Layer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""纯Keras实现CRF层
    CRF层本质上是一个带训练参数的loss计算层，因此CRF层只用来训练模型，
    而预测则需要另外建立模型。
    """</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ignore_last_label<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""ignore_last_label：定义要不要忽略最后一个标签，起到mask的效果
        """</span>
        self<span class="token punctuation">.</span>ignore_last_label <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">if</span> ignore_last_label <span class="token keyword">else</span> <span class="token number">0</span>
        super<span class="token punctuation">(</span>CRF<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">build</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_shape<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>num_labels <span class="token operator">=</span> input_shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>ignore_last_label
        self<span class="token punctuation">.</span>trans <span class="token operator">=</span> self<span class="token punctuation">.</span>add_weight<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'crf_trans'</span><span class="token punctuation">,</span>
                                     shape<span class="token operator">=</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_labels<span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_labels<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                     initializer<span class="token operator">=</span><span class="token string">'glorot_uniform'</span><span class="token punctuation">,</span>
                                     trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">log_norm_step</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">,</span> states<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""递归计算归一化因子
        要点：1、递归计算；2、用logsumexp避免溢出。
        技巧：通过expand_dims来对齐张量。
        """</span>
        states <span class="token operator">=</span> K<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># (batch_size, output_dim, 1)</span>
        trans <span class="token operator">=</span> K<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>self<span class="token punctuation">.</span>trans<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># (1, output_dim, output_dim)</span>
        output <span class="token operator">=</span> K<span class="token punctuation">.</span>logsumexp<span class="token punctuation">(</span>states<span class="token operator">+</span>trans<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># (batch_size, output_dim)</span>
        <span class="token keyword">return</span> output<span class="token operator">+</span>inputs<span class="token punctuation">,</span> <span class="token punctuation">[</span>output<span class="token operator">+</span>inputs<span class="token punctuation">]</span>
    <span class="token keyword">def</span> <span class="token function">path_score</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""计算目标路径的相对概率（还没有归一化）
        要点：逐标签得分，加上转移概率得分。
        技巧：用“预测”点乘“目标”的方法抽取出目标路径的得分。
        """</span>
        point_score <span class="token operator">=</span> K<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>K<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>inputs<span class="token operator">*</span>labels<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 逐标签得分</span>
        labels1 <span class="token operator">=</span> K<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>labels<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        labels2 <span class="token operator">=</span> K<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>labels<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        labels <span class="token operator">=</span> labels1 <span class="token operator">*</span> labels2 <span class="token comment" spellcheck="true"># 两个错位labels，负责从转移矩阵中抽取目标转移得分</span>
        trans <span class="token operator">=</span> K<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>K<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>self<span class="token punctuation">.</span>trans<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        trans_score <span class="token operator">=</span> K<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>K<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>trans<span class="token operator">*</span>labels<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> point_score<span class="token operator">+</span>trans_score <span class="token comment" spellcheck="true"># 两部分得分之和</span>
    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># CRF本身不改变输出，它只是一个loss</span>
        <span class="token keyword">return</span> inputs
    <span class="token keyword">def</span> <span class="token function">loss</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 目标y_pred需要是one hot形式</span>
        mask <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">-</span>y_true<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>ignore_last_label <span class="token keyword">else</span> None
        y_true<span class="token punctuation">,</span>y_pred <span class="token operator">=</span> y_true<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>num_labels<span class="token punctuation">]</span><span class="token punctuation">,</span>y_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>num_labels<span class="token punctuation">]</span>
        init_states <span class="token operator">=</span> <span class="token punctuation">[</span>y_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 初始状态</span>
        log_norm<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_ <span class="token operator">=</span> K<span class="token punctuation">.</span>rnn<span class="token punctuation">(</span>self<span class="token punctuation">.</span>log_norm_step<span class="token punctuation">,</span> y_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> init_states<span class="token punctuation">,</span> mask<span class="token operator">=</span>mask<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 计算Z向量（对数）</span>
        log_norm <span class="token operator">=</span> K<span class="token punctuation">.</span>logsumexp<span class="token punctuation">(</span>log_norm<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 计算Z（对数）</span>
        path_score <span class="token operator">=</span> self<span class="token punctuation">.</span>path_score<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y_true<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 计算分子（对数）</span>
        <span class="token keyword">return</span> log_norm <span class="token operator">-</span> path_score <span class="token comment" spellcheck="true"># 即log(分子/分母)</span>
    <span class="token keyword">def</span> <span class="token function">accuracy</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 训练过程中显示逐帧准确率的函数，排除了mask的影响</span>
        mask <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">-</span>y_true<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>ignore_last_label <span class="token keyword">else</span> None
        y_true<span class="token punctuation">,</span>y_pred <span class="token operator">=</span> y_true<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>num_labels<span class="token punctuation">]</span><span class="token punctuation">,</span>y_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>num_labels<span class="token punctuation">]</span>
        isequal <span class="token operator">=</span> K<span class="token punctuation">.</span>equal<span class="token punctuation">(</span>K<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> K<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        isequal <span class="token operator">=</span> K<span class="token punctuation">.</span>cast<span class="token punctuation">(</span>isequal<span class="token punctuation">,</span> <span class="token string">'float32'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> mask <span class="token operator">==</span> None<span class="token punctuation">:</span>
            <span class="token keyword">return</span> K<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>isequal<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> K<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>isequal<span class="token operator">*</span>mask<span class="token punctuation">)</span> <span class="token operator">/</span> K<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>mask<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>除去注释和accuracy的代码，真正的CRF的代码量也就30行左右，可以说跟哪个框架比较都称得上是简明的CRF实现了吧～</p><p>用纯Keras实现一些复杂的模型，是一件颇有意思的事情。目前仅在tensorflow后端测试通过，理论上兼容theano、cntk后端，但可能要自行微调。</p><h3 id="使用案例">使用案例<a href="https://kexue.fm/archives/5542#%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"> #</a></h3><p>我的Github中还附带了一个<strong>使用CNN+CRF实现的中文分词</strong>的例子，用的是<a href="http://sighan.cs.uchicago.edu/bakeoff2005/" target="_blank">Bakeoff 2005</a>语料，例子是一个完整的分词实现，包括viterbi算法、分词输出等。</p><p>Github地址：<a href="https://github.com/bojone/crf/" target="_blank">https://github.com/bojone/crf/</a></p><p>相关的内容还可以看我之前的文章：</p><blockquote><p>1、<a href="https://kexue.fm/archives/3924" target="_blank">【中文分词系列】 4. 基于双向LSTM的seq2seq字标注</a></p><p>2、<a href="https://kexue.fm/archives/4195" target="_blank">【中文分词系列】 6. 基于全卷积网络的中文分词</a></p></blockquote><h2 id="结语">结语<a href="https://kexue.fm/archives/5542#%E7%BB%93%E8%AF%AD"> #</a></h2><p>终于介绍完了，希望大家有所收获，也希望最后的实现能对大家有所帮助～</p>
                <p style="color: #FF8800; margin-top: 30px; margin-bottom: 0px"><em><strong>转载到请包括本文地址：</strong><a href="https://kexue.fm/archives/5542" rel="bookmark" title="简明条件随机场CRF介绍（附带纯Keras实现）">https://kexue.fm/archives/5542</a></em></p>
                <p style="color: #FF8800; margin-top: 0px; margin-bottom: 15px"><em><strong>更详细的转载事宜请参考：</strong></em><a href="https://kexue.fm/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" rel="bookmark" title="《科学空间FAQ》">《科学空间FAQ》</a></p>
                <div id="content_tips">
                <p style="border-top: 1px solid #ddd; color: #FF8800; padding-top: 5px"><strong>如果您还有什么疑惑或建议，欢迎在下方评论区继续讨论。</strong></p>
                <p style="color: #FF8800"><strong>如果您觉得本文还不错，欢迎<a href="https://kexue.fm/archives/5542#share">分享</a>/<a href="https://kexue.fm/archives/5542#pay">打赏</a>本文。打赏并非要从中获得收益，而是希望知道科学空间获得了多少读者的真心关注。当然，如果你无视它，也不会影响你的阅读。再次表示欢迎和感谢！</strong></p>
                </div>

                        <div id="pay" style="padding: 10px 0; margin: 20px auto; width: 100%; font-size:16px; text-align: center;">
                <button id="payButton" disable="enable" onclick="var qr = document.getElementById(&#39;QR&#39;); if (qr.style.display === &#39;none&#39;) {qr.style.display = &#39;block&#39;;} else {qr.style.display = &#39;none&#39;}">
                    <span>打赏</span>
                </button>
                <div id="QR" style="display: none;">
                    <div id="wechat" style="display: inline-block">
                        <a class="fancybox" rel="group"><img id="wechat_qr" src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/wx.png" alt="科学空间"></a>
                        <p>微信打赏</p>
                    </div>
                    <div id="alipay" style="display: inline-block">
                        <a class="fancybox" rel="group"><img id="alipay_qr" src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/zfb.png" alt="科学空间"></a>
                        <p>支付宝打赏</p>
                    </div>
                    <p><font color="red">因为网站后台对打赏并无记录，因此欢迎在打赏时候备注留言。</font><br>你还可以<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ" target="_blank"><strong>点击这里</strong></a>或在下方评论区留言来告知你的建议或需求。</p>
                </div>
            </div>
                <div id="how_to_cite">
                    <p><strong>如果您需要引用本文，请参考：</strong></p>
                    <p style="font-size: 12px">苏剑林. (2018, May 18). 《简明条件随机场CRF介绍（附带纯Keras实现） 》[Blog post]. Retrieved from <a href="https://kexue.fm/archives/5542">https://kexue.fm/archives/5542</a></p>
                </div>

            </div>
            <div class="clear"></div>
        </div>
        <div id="tools" class="tools">
            <span class="cat">分类：<a href="https://kexue.fm/category/Big-Data">信息时代</a>&nbsp; &nbsp; 标签：<a href="https://kexue.fm/tag/%E6%A8%A1%E5%9E%8B/">模型</a>, <a href="https://kexue.fm/tag/%E6%A6%82%E7%8E%87%E5%9B%BE/">概率图</a>, <a href="https://kexue.fm/tag/keras/">keras</a>            </span>

            <span class="comment_comments">
                <a href="https://kexue.fm/archives/5542#comments">65 评论</a>
            </span>     
        </div>
        <div id="entrynavigation" class="entrynavigation">
            <font color="green">&lt;</font> <a href="https://kexue.fm/archives/5533" title="【致敬】费曼诞辰100年">【致敬】费曼诞辰100年</a> | <a href="https://kexue.fm/archives/5570" title="厨房，菜市场，其实都是武林">厨房，菜市场，其实都是武林</a> <font color="green">&gt;</font>
        </div>

        
        <div id="similar">
            <h3>你也许还对下面的内容感兴趣</h3>
            <ul style="padding: 0;">
                                                                            <li>
                            <a href="https://kexue.fm/archives/6992" title="BN究竟起了什么作用？一个闭门造车的分析">BN究竟起了什么作用？一个闭门造车的分析</a>
                        </li>
                                            <li>
                            <a href="https://kexue.fm/archives/6985" title="“让Keras更酷一些！”：层与模型的重用技巧">“让Keras更酷一些！”：层与模型的重用技巧</a>
                        </li>
                                            <li>
                            <a href="https://kexue.fm/archives/6933" title="从语言模型到Seq2Seq：Transformer如戏，全靠Mask">从语言模型到Seq2Seq：Transformer如戏，全靠Mask</a>
                        </li>
                                            <li>
                            <a href="https://kexue.fm/archives/6919" title="百度实体链接比赛后记：行为建模和实体链接">百度实体链接比赛后记：行为建模和实体链接</a>
                        </li>
                                            <li>
                            <a href="https://kexue.fm/archives/6915" title="自己实现了一个bert4keras">自己实现了一个bert4keras</a>
                        </li>
                                            <li>
                            <a href="https://kexue.fm/archives/6906" title="开源一版DGCNN阅读理解问答模型（Keras版）">开源一版DGCNN阅读理解问答模型（Keras版）</a>
                        </li>
                                            <li>
                            <a href="https://kexue.fm/archives/6877" title="seq2seq之双向解码">seq2seq之双向解码</a>
                        </li>
                                            <li>
                            <a href="https://kexue.fm/archives/6869" title="Keras实现两个优化器：Lookahead和LazyOptimizer">Keras实现两个优化器：Lookahead和LazyOptimizer</a>
                        </li>
                                            <li>
                            <a href="https://kexue.fm/archives/6853" title="为节约而生：从标准Attention到稀疏Attention">为节约而生：从标准Attention到稀疏Attention</a>
                        </li>
                                            <li>
                            <a href="https://kexue.fm/archives/6810" title="“让Keras更酷一些！”：层中层与mask">“让Keras更酷一些！”：层中层与mask</a>
                        </li>
                                                     
            </ul>
            <div class="clear"></div>
        </div>

    <div id="PostComment">
        <a href="https://kexue.fm/archives/5542#comment_form">发表你的看法</a>
    </div>

    
<script>
    
    //评论预览功能
    var Comment_Preview = {
  delay: 150,        // delay after keystroke before updating
  preview: null,     // filled in by Init below
  buffer: null,      // filled in by Init below
  timeout: null,     // store setTimout id
  mjRunning: false,  // true when MathJax is processing
  mjPending: false,  // true when a typeset has been queued
  oldText: null,     // used to check if an update is needed
  //
  //  Get the preview and buffer DIV's
  //
  Init: function () {
    this.preview = document.getElementById("comment_preview");
    this.buffer = document.getElementById("comment_buffer");
},
  //
  //  Switch the buffer and preview, and display the right one.
  //  (We use visibility:hidden rather than display:none since
  //  the results of running MathJax are more accurate that way.)
  //
  SwapBuffers: function () {
    var buffer = this.preview, preview = this.buffer;
    this.buffer = buffer; this.preview = preview;
    buffer.style.visibility = "hidden"; buffer.style.position = "absolute";
    preview.style.position = ""; preview.style.visibility = "";
},
  //
  //  This gets called when a key is pressed in the textarea.
  //  We check if there is already a pending update and clear it if so.
  //  Then set up an update to occur after a small delay (so if more keys
  //    are pressed, the update won't occur until after there has been 
  //    a pause in the typing).
  //  The callback function is set up below, after the Comment_Preview object is set up.
  //
  Update: function () {
    if (this.timeout) {clearTimeout(this.timeout)}
        this.timeout = setTimeout(this.callback,this.delay);
},
  //
  //  Creates the preview and runs MathJax on it.
  //  If MathJax is already trying to render the code, return
  //  If the text hasn't changed, return
  //  Otherwise, indicate that MathJax is running, and start the
  //    typesetting.  After it is done, call Comment_PreviewDone.
  //  
  CreateComment_Preview: function () {
    Comment_Preview.timeout = null;
    if (this.mjPending) return;
    var text = document.getElementById("comment_texts").value;
    text = text.replace(/\n/g, '<br>');
    var subStr=new RegExp('\\[comment=(.*?)\\](.*?)\\[\\/comment\\]', 'ig');
    text = text.replace(subStr, '<a href="#comment-$1">@$2|$1</a>');
    if (text === this.oldtext) return;
    if (this.mjRunning) {
      this.mjPending = true;
      MathJax.Hub.Queue(["CreateComment_Preview",this]);
  } else {
      this.buffer.innerHTML = this.oldtext = text;
      this.mjRunning = true;
      MathJax.Hub.Queue(
          ["Typeset",MathJax.Hub,this.buffer],
          ["Comment_PreviewDone",this]
          );
  }
},
  //
  //  Indicate that MathJax is no longer running,
  //  and swap the buffers to show the results.
  //
  Comment_PreviewDone: function () {
    this.mjRunning = this.mjPending = false;
    this.SwapBuffers();
}
};
//
//  Cache a callback to the CreateComment_Preview action
//
Comment_Preview.callback = MathJax.Callback(["CreateComment_Preview",Comment_Preview]);
Comment_Preview.callback.autoReset = true;  // make sure it can run more than once


    //评论引用功能
    function Cite_Comment(comment_id, author_name){  
        document.getElementById('comment_texts').value += ('[comment=' + comment_id.replace('comment-','') + ']' + author_name + '[/comment]\n\n');
        var this_url = window.location.href;
        window.location.href='#comment_texts';
        Comment_Preview.Update();
        window.history.pushState({}, 0, this_url.split('#')[0]+'#'+comment_id); // 修改地址栏，方便需要复制评论地址的读者
    }

</script>

<div id="comments">

    
            <div id="pages">
            <ul>
                <ol class="page-navigator"><li class="prev"><a href="https://kexue.fm/archives/5542/comment-page-2#comments">«</a></li><li><a href="https://kexue.fm/archives/5542/comment-page-1#comments">1</a></li><li><a href="https://kexue.fm/archives/5542/comment-page-2#comments">2</a></li><li class="current"><a href="https://kexue.fm/archives/5542/comment-page-3#comments">3</a></li></ol>            </ul>
        </div>
         
        <div class="AllComments">
            <div class="ComListLi">
            
            <div class="ListUser">LYF</div>
            <p class="ListDate">July 25th, 2019</p><span class="ListNr"><input type="button" class="cite_comment" onclick="Cite_Comment(&#39;comment-11712&#39;, &#39;LYF&#39;)" value="1" style="font: normal 24px/24px &#39;Arial&#39;;"></span>
            <div id="comment-11712" class="ListContent"> 
                
                <p>请问，作为一个初学keras的人要先看哪些再看这个才能看懂。。。。。。。。。。。</p>                <div class="comment_reply">
                    <a href="https://kexue.fm/archives/5542/comment-page-3?replyTo=11712#respond-post-5542" rel="nofollow" onclick="return TypechoComment.reply(&#39;comment-11712&#39;, 11712);">回复评论</a>                </div>                   
            </div>
                <div class="subcomments">
        <div class="comment_2 odd">
            <div class="comment_data">

                <span><input type="button" class="cite_comment" onclick="Cite_Comment(&#39;comment-11713&#39;, &#39;苏剑林&#39;)" value="第2层"></span>
                <a href="https://kexue.fm/" rel="external nofollow" target="_blank">苏剑林</a> 发表于
                July 26th, 2019            </div>
            <div id="comment-11713" class="comment_content">
                <p>只需要两点：</p><p>1、熟悉tensor运算规则，或者熟悉numpy运算都行；<br>
2、熟悉矩阵计算。</p>                <div class="comment_reply">
                    <a href="https://kexue.fm/archives/5542/comment-page-3?replyTo=11713#respond-post-5542" rel="nofollow" onclick="return TypechoComment.reply(&#39;comment-11713&#39;, 11713);">回复评论</a>                </div>
            </div>
        </div>
            </div>
            </div>  
            <div class="ComListLi">
            
            <div class="ListUser"><a href="https://github.com/312shan" rel="external nofollow" target="_blank">cys</a></div>
            <p class="ListDate">July 31st, 2019</p><span class="ListNr"><input type="button" class="cite_comment" onclick="Cite_Comment(&#39;comment-11728&#39;, &#39;cys&#39;)" value="2" style="font: normal 24px/24px &#39;Arial&#39;;"></span>
            <div id="comment-11728" class="ListContent"> 
                
                <p>同样是学，为何你这么强？大神能否写一篇你研究新技术从理解到能自己底层实现一些学习方法、心得？如果工作了怎么可能有这么多时间编写这么多高质量的文章？这不是光靠熬夜做到的吧？哈哈</p>                <div class="comment_reply">
                    <a href="https://kexue.fm/archives/5542/comment-page-3?replyTo=11728#respond-post-5542" rel="nofollow" onclick="return TypechoComment.reply(&#39;comment-11728&#39;, 11728);">回复评论</a>                </div>                   
            </div>
                <div class="subcomments">
        <div class="comment_2 odd">
            <div class="comment_data">

                <span><input type="button" class="cite_comment" onclick="Cite_Comment(&#39;comment-11737&#39;, &#39;苏剑林&#39;)" value="第3层"></span>
                <a href="https://kexue.fm/" rel="external nofollow" target="_blank">苏剑林</a> 发表于
                August 1st, 2019            </div>
            <div id="comment-11737" class="comment_content">
                <p>方法就是：多看多想，别糊弄自己。</p>                <div class="comment_reply">
                    <a href="https://kexue.fm/archives/5542/comment-page-3?replyTo=11737#respond-post-5542" rel="nofollow" onclick="return TypechoComment.reply(&#39;comment-11737&#39;, 11737);">回复评论</a>                </div>
            </div>
        </div>
            </div>
            </div>  
            <div class="ComListLi">
            
            <div class="ListUser">affric</div>
            <p class="ListDate">July 31st, 2019</p><span class="ListNr"><input type="button" class="cite_comment" onclick="Cite_Comment(&#39;comment-11733&#39;, &#39;affric&#39;)" value="3" style="font: normal 24px/24px &#39;Arial&#39;;"></span>
            <div id="comment-11733" class="ListContent"> 
                
                <p>为什么训练卡在第一步不动呢，求解答</p>                <div class="comment_reply">
                    <a href="https://kexue.fm/archives/5542/comment-page-3?replyTo=11733#respond-post-5542" rel="nofollow" onclick="return TypechoComment.reply(&#39;comment-11733&#39;, 11733);">回复评论</a>                </div>                   
            </div>
                <div class="subcomments">
        <div class="comment_2 odd">
            <div class="comment_data">

                <span><input type="button" class="cite_comment" onclick="Cite_Comment(&#39;comment-11738&#39;, &#39;苏剑林&#39;)" value="第4层"></span>
                <a href="https://kexue.fm/" rel="external nofollow" target="_blank">苏剑林</a> 发表于
                August 1st, 2019            </div>
            <div id="comment-11738" class="comment_content">
                <p>我也不知道。</p>                <div class="comment_reply">
                    <a href="https://kexue.fm/archives/5542/comment-page-3?replyTo=11738#respond-post-5542" rel="nofollow" onclick="return TypechoComment.reply(&#39;comment-11738&#39;, 11738);">回复评论</a>                </div>
            </div>
        </div>
            </div>
            </div>  
            <div class="ComListLi">
            
            <div class="ListUser">Miracle</div>
            <p class="ListDate">October 15th, 2019</p><span class="ListNr"><input type="button" class="cite_comment" onclick="Cite_Comment(&#39;comment-12184&#39;, &#39;Miracle&#39;)" value="4" style="font: normal 24px/24px &#39;Arial&#39;;"></span>
            <div id="comment-12184" class="ListContent"> 
                
                <p>苏神你好，（5）式中的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1385" style="width: 3.833em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.457em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.205em, 1003.38em, 2.631em, -999.996em); top: -2.173em; left: 0em;"><span class="mrow" id="MathJax-Span-1386"><span class="mi" id="MathJax-Span-1387" style="font-family: MathJax_Math-italic;">h</span><span class="mrow" id="MathJax-Span-1388" style="padding-left: 0.154em;"><span class="mo" id="MathJax-Span-1389" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1390"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.43em, 1000.45em, 2.556em, -999.996em); top: -2.098em; left: 0em;"><span class="mi" id="MathJax-Span-1391" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 2.106em;"></span></span><span style="position: absolute; top: -1.948em; left: 0.454em;"><span class="texatom" id="MathJax-Span-1392"><span class="mrow" id="MathJax-Span-1393"><span class="mn" id="MathJax-Span-1394" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.106em;"></span></span></span></span><span class="mo" id="MathJax-Span-1395" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-1396" style="font-family: MathJax_Math-bold-italic; padding-left: 0.154em;">x</span><span class="mo" id="MathJax-Span-1397" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.181em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.329em; border-left: 0px solid; width: 0px; height: 1.254em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mrow><mo>(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-69">h\left(y_{1} ; \boldsymbol{x}\right)</script>是否应该是<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1398" style="width: 3.682em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.307em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.205em, 1003.23em, 2.631em, -999.996em); top: -2.173em; left: 0em;"><span class="mrow" id="MathJax-Span-1399"><span class="mi" id="MathJax-Span-1400" style="font-family: MathJax_Math-italic;">h</span><span class="mrow" id="MathJax-Span-1401" style="padding-left: 0.154em;"><span class="mo" id="MathJax-Span-1402" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1403"><span style="display: inline-block; position: relative; width: 0.755em; height: 0px;"><span style="position: absolute; clip: rect(1.43em, 1000.45em, 2.556em, -999.996em); top: -2.098em; left: 0em;"><span class="mi" id="MathJax-Span-1404" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 2.106em;"></span></span><span style="position: absolute; top: -1.948em; left: 0.454em;"><span class="texatom" id="MathJax-Span-1405"><span class="mrow" id="MathJax-Span-1406"><span class="mi" id="MathJax-Span-1407" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.106em;"></span></span></span></span><span class="mo" id="MathJax-Span-1408" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-1409" style="font-family: MathJax_Math-bold-italic; padding-left: 0.154em;">x</span><span class="mo" id="MathJax-Span-1410" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.181em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.329em; border-left: 0px solid; width: 0px; height: 1.254em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mrow><mo>(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>;</mo><mi mathvariant="bold-italic">x</mi><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-70">h\left(y_{i} ; \boldsymbol{x}\right)</script>？我觉得应该是这样的吧。</p>                <div class="comment_reply">
                    <a href="https://kexue.fm/archives/5542/comment-page-3?replyTo=12184#respond-post-5542" rel="nofollow" onclick="return TypechoComment.reply(&#39;comment-12184&#39;, 12184);">回复评论</a>                </div>                   
            </div>
                <div class="subcomments">
        <div class="comment_2 odd">
            <div class="comment_data">

                <span><input type="button" class="cite_comment" onclick="Cite_Comment(&#39;comment-12185&#39;, &#39;Miracle&#39;)" value="第5层"></span>
                Miracle 发表于
                October 15th, 2019            </div>
            <div id="comment-12185" class="comment_content">
                <p>不好意思我看错了（捂脸），苏神是正确的</p>                <div class="comment_reply">
                    <a href="https://kexue.fm/archives/5542/comment-page-3?replyTo=12185#respond-post-5542" rel="nofollow" onclick="return TypechoComment.reply(&#39;comment-12185&#39;, 12185);">回复评论</a>                </div>
            </div>
        </div>
            </div>
            </div>  
            <div class="ComListLi">
            
            <div class="ListUser">石语</div>
            <p class="ListDate">October 25th, 2019</p><span class="ListNr"><input type="button" class="cite_comment" onclick="Cite_Comment(&#39;comment-12252&#39;, &#39;石语&#39;)" value="5" style="font: normal 24px/24px &#39;Arial&#39;;"></span>
            <div id="comment-12252" class="ListContent"> 
                
                <p>老师您好，看了您的博客，收获颇丰，我现在有2个问题，期待您的解答:</p><p>问题1：看您在计算配分函数的时候使用了k.rnn  函数，请问一下，如果我直接按照您的公式（10）去计算配分函数，可行吗，或者说对序列标注的最终效果影响大吗？</p><p>问题2：这个函数 def loss(self, y_true, y_pred)，其中的y_pred是LSTM的输出对吧（其形状为[batch_size,time_step,class_label]）？其中y_true是one-hot形式，数据形状也是[batch_size,time_step,class_label],对吗？</p>                <div class="comment_reply">
                    <a href="https://kexue.fm/archives/5542/comment-page-3?replyTo=12252#respond-post-5542" rel="nofollow" onclick="return TypechoComment.reply(&#39;comment-12252&#39;, 12252);">回复评论</a>                </div>                   
            </div>
                    </div>  
        </div>
    
            <div id="bottom_pages">
            <ul>
                <ol class="page-navigator"><li class="prev"><a href="https://kexue.fm/archives/5542/comment-page-2#comments">«</a></li><li><a href="https://kexue.fm/archives/5542/comment-page-1#comments">1</a></li><li><a href="https://kexue.fm/archives/5542/comment-page-2#comments">2</a></li><li class="current"><a href="https://kexue.fm/archives/5542/comment-page-3#comments">3</a></li></ol>            </ul>
        </div>
     
            <div id="respond-post-5542" class="respond">
            <div class="cancle_comment_reply"><a id="cancel-comment-reply-link" href="https://kexue.fm/archives/5542#respond-post-5542" rel="nofollow" style="display:none" onclick="return TypechoComment.cancelReply();">取消回复</a></div>
            <form method="post" action="https://kexue.fm/archives/5542/comment" id="comment_form">
                                    <p>
                        <input type="text" name="author" id="author" class="comment_infos" size="14" value="">
                        <label for="author">你的大名</label>
                    </p>
                    <p>
                        <input type="text" name="mail" id="mail" class="comment_infos" size="14" value="">
                        <label for="mail">电子邮箱</label>
                    </p>
                    <p>
                        <input type="text" name="url" id="url" class="comment_infos" size="14" value="">
                        <label for="url">个人网站（选填）</label>
                    </p>
                                <p><textarea name="text" id="comment_texts" onkeyup="Comment_Preview.Update()"></textarea></p>
                <p>1. 可以在评论中使用LaTeX代码，点击“预览效果”可即时查看效果，点击<a href="https://kexue.fm/content.html" target="_blank">这里</a>可以查看更多内容；<br>2. 可以通过点击评论楼层编号来引用该楼层。</p>
                <p><input type="submit" value="提交评论" class="submit">  <input type="button" id="preview_button" value="预览效果" class="submit" onclick="var preview = document.getElementById(&#39;preview&#39;); if (preview.style.display === &#39;none&#39;) {preview.style.display=&#39;block&#39;; document.getElementById(&#39;preview_button&#39;).value=&#39;隐藏预览&#39;;} else {preview.style.display=&#39;none&#39;; document.getElementById(&#39;preview_button&#39;).value=&#39;预览效果&#39;;}"></p>
            <input type="hidden" name="_" value="e00758244fe9800b3455e95f3949d61d"></form>

            <div id="preview" style="display: none; margin-bottom: 10px">
                <div id="comment_preview" style="padding: 5px; min-height: 125px; width: 100%; border: 1px solid #ccc; word-break: break-all; word-wrap: break-word; color: #666; box-sizing: border-box"></div>
                <div id="comment_buffer" style="padding: 5px; min-height: 125px; width: 100%; border: 1px solid #ccc; visibility: hidden; position: absolute; top: 0; left: 0; word-break: break-all; word-wrap: break-word; color: #666; box-sizing: border-box"></div>
            </div>

            <script>
                Comment_Preview.Init();
                //超链接都在新页面打开
                var anchors = document.getElementById('comments').getElementsByTagName('a');
                for (i=0; i<anchors.length; i++) {
                    var anchor_item = anchors[i];
                    if (anchor_item.getAttribute("rel") == 'external nofollow') {
                        anchor_item.target = '_blank';
                    }
                }
            </script>

        </div>
        
</div>
    </div>

    <!-- end #content-->
    <div id="SideBar">
    
    <!-- 页面是非文章页 或 没有找到目录 -->
    
            <div class="alt-wrapper">
                <b class="rtop">
                    <b class="r1"></b>
                    <b class="r2"></b>
                    <b class="r3"></b>
                    <b class="r4"></b>
                </b>
                <div class="inner-wrapper">
                    <h3>内容速览</h3>
                    <div class="tableofcontents"><li class="toc-2"><a href="https://kexue.fm/archives/5542#%E5%9B%BE%E7%A4%BA">图示</a></li>
<li class="toc-3"><a href="https://kexue.fm/archives/5542#%E9%80%90%E5%B8%A7softmax">逐帧softmax</a></li>
<li class="toc-3"><a href="https://kexue.fm/archives/5542#%E6%9D%A1%E4%BB%B6%E9%9A%8F%E6%9C%BA%E5%9C%BA">条件随机场</a></li>
<li class="toc-2"><a href="https://kexue.fm/archives/5542#%E6%95%B0%E5%AD%A6">数学</a></li>
<li class="toc-3"><a href="https://kexue.fm/archives/5542#%E6%A8%A1%E5%9E%8B%E6%A6%82%E8%A6%81">模型概要</a></li>
<li class="toc-3"><a href="https://kexue.fm/archives/5542#%E7%BA%BF%E6%80%A7%E9%93%BECRF">线性链CRF</a></li>
<li class="toc-3"><a href="https://kexue.fm/archives/5542#%E5%BD%92%E4%B8%80%E5%8C%96%E5%9B%A0%E5%AD%90">归一化因子</a></li>
<li class="toc-3"><a href="https://kexue.fm/archives/5542#%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92">动态规划</a></li>
<li class="toc-2"><a href="https://kexue.fm/archives/5542#%E5%AE%9E%E7%8E%B0">实现</a></li>
<li class="toc-3"><a href="https://kexue.fm/archives/5542#%E5%AE%9E%E7%8E%B0%E8%A6%81%E7%82%B9">实现要点</a></li>
<li class="toc-3"><a href="https://kexue.fm/archives/5542#%E4%BB%A3%E7%A0%81%E9%80%9F%E8%A7%88">代码速览</a></li>
<li class="toc-3"><a href="https://kexue.fm/archives/5542#%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B">使用案例</a></li>
<li class="toc-2"><a href="https://kexue.fm/archives/5542#%E7%BB%93%E8%AF%AD">结语</a></li></div>                </div>
                <b class="rbottom">
                    <b class="r4"></b>
                    <b class="r3"></b>
                    <b class="r2"></b>
                    <b class="r1"></b>
                </b>
            </div>

        
        <div id="searchblock">
            <h3>智能搜索</h3>
            <div id="right_search_form">
                <form method="post" action="https://kexue.fm/archives/5542">
                    <div><input type="text" onfocus="if(this.value==&#39;请输入关键词&#39;) this.value=&#39;&#39;;" onblur="if(this.value==&#39;&#39;) this.value=&#39;请输入关键词&#39;;" value="请输入关键词" name="s" size="15"> <input class="btn_search_small" type="submit" value=""></div>
                </form>
            </div>
            <div class="text">支持整句搜索！网站自动使用<a href="https://github.com/fxsjy/jieba" target="_blank">结巴分词</a>进行分词，并结合ngrams排序算法给出合理的搜索结果。</div>
        </div>

        <div class="alt-wrapper">
            <b class="rtop">
                <b class="r1"></b>
                <b class="r2"></b>
                <b class="r3"></b>
                <b class="r4"></b>
            </b>
            <div class="inner-wrapper">
                <h3>热门标签</h3>
                <div style="margin:7px 0px 0px 0px;"><ul>
                      
                      
                        <a href="https://kexue.fm/tag/%E7%BD%91%E7%AB%99/">网站</a>
                      
                        <a href="https://kexue.fm/tag/%E8%BD%AC%E8%BD%BD/">转载</a>
                      
                        <a href="https://kexue.fm/tag/%E5%A4%A9%E8%B1%A1/">天象</a>
                      
                        <a href="https://kexue.fm/tag/%E6%A8%A1%E5%9E%8B/">模型</a>
                      
                        <a href="https://kexue.fm/tag/%E7%A7%AF%E5%88%86/">积分</a>
                      
                        <a href="https://kexue.fm/tag/python/">python</a>
                      
                        <a href="https://kexue.fm/tag/%E5%8A%9B%E5%AD%A6/">力学</a>
                      
                        <a href="https://kexue.fm/tag/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a>
                      
                        <a href="https://kexue.fm/tag/%E6%A6%82%E7%8E%87/">概率</a>
                      
                        <a href="https://kexue.fm/tag/%E8%8A%82%E6%97%A5/">节日</a>
                      
                        <a href="https://kexue.fm/tag/%E6%95%B0%E8%AE%BA/">数论</a>
                      
                        <a href="https://kexue.fm/tag/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/">微分方程</a>
                      
                        <a href="https://kexue.fm/tag/%E5%87%A0%E4%BD%95/">几何</a>
                      
                        <a href="https://kexue.fm/tag/%E6%96%B9%E7%A8%8B/">方程</a>
                      
                        <a href="https://kexue.fm/tag/%E7%94%9F%E6%B4%BB/">生活</a>
                      
                        <a href="https://kexue.fm/tag/%E8%B4%B9%E6%9B%BC/">费曼</a>
                      
                        <a href="https://kexue.fm/tag/%E6%83%85%E6%84%9F/">情感</a>
                      
                        <a href="https://kexue.fm/tag/%E5%A4%8D%E6%95%B0/">复数</a>
                      
                        <a href="https://kexue.fm/tag/%E7%9F%A9%E9%98%B5/">矩阵</a>
                      
                        <a href="https://kexue.fm/tag/%E7%AB%9E%E8%B5%9B/">竞赛</a>
                      
                        <a href="https://kexue.fm/tag/%E6%97%A0%E7%9B%91%E7%9D%A3/">无监督</a>
                      
                        <a href="https://kexue.fm/tag/%E7%BF%BB%E8%AF%91/">翻译</a>
                      
                        <a href="https://kexue.fm/tag/%E5%BC%95%E5%8A%9B/">引力</a>
                      
                        <a href="https://kexue.fm/tag/%E7%BA%A7%E6%95%B0/">级数</a>
                      
                        <a href="https://kexue.fm/tag/%E7%B4%A0%E6%95%B0/">素数</a>
                                    </ul></div>
            </div>
            <b class="rbottom">
                <b class="r4"></b>
                <b class="r3"></b>
                <b class="r2"></b>
                <b class="r1"></b>
            </b>
        </div>


                    <div class="diggwrapper">
                <b class="rtop">
                    <b class="r1"></b>
                    <b class="r2"></b>
                    <b class="r3"></b>
                    <b class="r4"></b>
                </b>
                <div class="inner-wrapper">
                    <h3>随机文章</h3>
                    <div>
                        <ul> 
                            <li><a href="https://kexue.fm/archives/6409">O-GAN：简单修改，让GAN的判别器变成一个编码器！</a></li><li><a href="https://kexue.fm/archives/5716">用变分推断统一理解生成模型（VAE、GAN、AAE、ALI）</a></li><li><a href="https://kexue.fm/archives/4159">【备忘】Python中断多重循环的几种思路</a></li><li><a href="https://kexue.fm/archives/3064">特殊的通项公式：二次非线性递推</a></li><li><a href="https://kexue.fm/archives/1914">新年快乐！桃花迎春！</a></li><li><a href="https://kexue.fm/archives/136">广州亚运歌曲《重逢》歌词(中英文版)</a></li><li><a href="https://kexue.fm/archives/898">与向量的渊源极深的四元数</a></li><li><a href="https://kexue.fm/archives/4059">【外微分浅谈】4. 微分不微</a></li><li><a href="https://kexue.fm/archives/171">两男一女分享2009年诺贝尔化学奖</a></li><li><a href="https://kexue.fm/archives/566">科学空间：2010年4月重要天象</a></li>                  
                        </ul>
                    </div>
                </div>                          
                <b class="rbottom">
                    <b class="r4"></b>
                    <b class="r3"></b>
                    <b class="r2"></b>
                    <b class="r1"></b>
                </b>                            
            </div>
         


        <div class="wrapper">
            <b class="rtop">
                <b class="r1"></b>
                <b class="r2"></b>
                <b class="r3"></b>
                <b class="r4"></b>
            </b>

            <div class="inner-wrapper">
                <div class="block-comment">
                    <h3>最近评论</h3>
                    <div class="content">
                        <ul>
                                                                                        <li><a href="https://kexue.fm/archives/6214/comment-page-1#comment-12260">余嘉诚</a>: 苏老师,非常感谢您一直以来的论文分享,我有个问题,就是请问一下,对于一个语音信号(x+n),那...</li>
                                                            <li><a href="https://kexue.fm/archives/6915/comment-page-1#comment-12259">且放白鹿青崖间</a>: 谢谢你修改的代码，对我的帮助非常大</li>
                                                            <li><a href="https://kexue.fm/archives/6736/comment-page-2#comment-12258">teddyl</a>: 已经过了些日子了，希望能与所帮助。
我也遇到类似问题，不过keras_bert已经给了解决方案...</li>
                                                            <li><a href="https://kexue.fm/archives/7031/comment-page-1#comment-12257">beader</a>: 词频统计的话 collections.Counter 会比 dict 快很多</li>
                                                            <li><a href="https://kexue.fm/archives/7031/comment-page-1#comment-12256">smartsl</a>: 答：单进程算法太烂的时候。哈哈</li>
                                                            <li><a href="https://kexue.fm/archives/3086/comment-page-1#comment-12253">Werner</a>: 受刻意练习理论的影响，我相信天生才华根本就不存在。</li>
                                                            <li><a href="https://kexue.fm/archives/5542/comment-page-3#comment-12252">石语</a>: 老师您好，看了您的博客，收获颇丰，我现在有2个问题，期待您的解答:问题1：看您在计算配分函数的...</li>
                                                            <li><a href="https://kexue.fm/archives/5807/comment-page-3#comment-12251">苏剑林</a>: 分母加<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1411" style="width: 0.529em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.454em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.43em, 1000.45em, 2.331em, -999.996em); top: -2.098em; left: 0em;"><span class="mrow" id="MathJax-Span-1412"><span class="mi" id="MathJax-Span-1413" style="font-family: MathJax_Math-italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.106em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.671em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϵ</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">\epsilon</script>防止除零错误，另外学习率小一点。</li>
                                                            <li><a href="https://kexue.fm/archives/5253/comment-page-7#comment-12250">chang li jun</a>: 非常感谢，我再理解理解</li>
                                                            <li><a href="https://kexue.fm/archives/5807/comment-page-3#comment-12249">张兴远</a>: 苏神你好，我想问一下您在训练NICE或者GLOW的时候有没有遇到数值溢出的问题，如果有是怎么解...</li>
                                                    </ul>
                   </div>
               </div>
          </div>
        <b class="rbottom">
            <b class="r4"></b>
            <b class="r3"></b>
            <b class="r2"></b>
            <b class="r1"></b>
        </b>
    </div>


    <div class="wrapper">
        <b class="rtop">
            <b class="r1"></b>
            <b class="r2"></b>
            <b class="r3"></b>
            <b class="r4"></b>
        </b>
        <div class="inner-wrapper">
            <h3>友情链接</h3>
            <div id="friends">
                <ul><li><a target="_blank" href="http://cosmostation.lamost.org/website/">宇宙驿站</a></li>

<li><a target="_blank" href="http://songshuhui.net/">科学松鼠会</a></li>

<li><a target="_blank" href="http://bbs.emath.ac.cn/">数学研发</a></li>

<li><a target="_blank" href="http://space.lamost.org/">空间天文网</a></li>

<li><a target="_blank" href="http://www.seatop.com.cn/">Seatop</a></li>

<li><a target="_blank" href="http://xiaoxia.org/">Xiaoxia</a></li>

<li><a target="_blank" href="https://kexue.fm/sci/integral/index.html">积分表-网络版</a></li>

<li><a target="_blank" href="http://www.matrix67.com/blog/">matrix67</a></li>

<li><a target="_blank" href="http://blog.dvxj.com/">丝路博傲</a></li>

<li><a target="_blank" href="http://www.physixfan.com/">宇宙的心弦</a></li>

<li><a target="_blank" href="http://www.changhai.org/">卢昌海主页</a></li>

<li><a target="_blank" href="http://taho.cc/">TAHOROOM</a></li>

<li><a target="_blank" href="http://www.ph4ntasy.com/">ph4ntasy 饭特稀</a></li>

<li><a target="_blank" href="http://www.2math.cn/">数学之家</a></li>

<li><a target="_blank" href="http://interesting-sky.china-vo.org/">有趣天文奇观</a></li>

<li><a target="_blank" href="http://www.dili520.com/">天文地理知识</a></li>

<li><a target="_blank" href="http://chuangzaoshi.com/">创造狮创意导航</a></li>

<li><a target="_blank" href="http://bsky.spaces.ac.cn/">bsky</a></li>

<li><a target="_blank" href="http://www.twistedwg.com/">TwistedW</a></li>

<li><a target="_blank" href="https://godweiyang.com/">godweiyang</a></li>

<li><a target="_blank" href="https://blog.ailemon.me/">AI柠檬</a></li>

<li><a target="_blank" href="https://drivingc.com/">DrivingC</a></li>

<li><a target="_blank" href="https://msst.longlan.xyz/">聚星科技论坛</a></li>

<li><a target="_blank" href="https://greatdk.com/">王登科-DK博客</a></li>

<li><a target="_blank" href="https://5663015.github.io/">贾维斯的小屋</a></li>

<li><a target="_blank" href="https://fyubang.com/">瓦特兰蒂斯</a></li>

<li><a target="_blank" href="https://kexue.fm/links.html">申请链接</a></li></ul>            </div>
        </div>
        <b class="rbottom">
            <b class="r4"></b>
            <b class="r3"></b>
            <b class="r2"></b>
            <b class="r1"></b>
        </b>
    </div>


    
</div><!-- end #sidebar -->    </div>

<div id="Footer">
    <p><a target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/2.5/cn/"><img src="./简明条件随机场CRF介绍（附带纯Keras实现） - 科学空间_Scientific Spaces_files/cc.gif" alt="署名-非商业用途-保持一致"></a> 本站采用创作共用版权协议，要求署名、非商业用途和保持一致。转载本站内容必须也遵循“<a target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/2.5/cn/">署名-非商业用途-保持一致</a>”的创作共用协议。 

        <br>
        © 2009-2019 Scientific Spaces. All rights reserved. Theme by <a target="_blank" href="http://www.laogui.com/">laogui</a>. Powered by <a target="_blank" href="http://typecho.org/">Typecho</a>. 备案号: <a target="_blank" href="http://www.miibeian.gov.cn/" title="粤ICP备09093259号">粤ICP备09093259号</a>。  
    </p><span class="myurl"></span>
</div>

<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?05a8a552590dfa8b88bcff93d9ec3ba8";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
    })();
</script>

<script>
// 评论ajax翻页
jQuery(document).ready(function($) {
    var comments = $("#comments"), // 评论部分id
        loadingText = "\u8bc4\u8bba\u6570\u636e\u52a0\u8f7d\u4e2d\x2e\x2e\x2e", // 加载loading提示
        ajaxed = false;
    $(document).on('click', '#comments .page-navigator li a', function(e){
        e.preventDefault();
        var _this = $(this),
            _thisP = _this.parent();
        if(_thisP.hasClass('current') || ajaxed==true) return; // 判断是否是当前页面
        var _list = $('.ComListLi'),
            url = _this.attr("href").replace("#comments", "") + "?action=ajax_comments";
            window.history.pushState({}, 0, _this.attr("href")); // 修改地址栏，方便复制评论
        $.ajax({ // Ajax请求
            url: url,
            beforeSend: function() {
                _list.text(loadingText);
                ajaxed = true;
            },
            success: function(data) {
                comments.html(data);
                ajaxed = false;
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            }
        });
        return false;
    });
});
</script>

<!-- end #footer -->
</div>
<script type="text/javascript">
var typechoAddCommentReply = function (cid, coid, cfid, style) {
    var _ce = document.getElementById(cid), _cp = _ce.parentNode;
    var _cf = document.getElementById(cfid);

    var _pi = document.getElementById('comment-parent');
    if (null == _pi) {
        _pi = document.createElement('input');
        _pi.setAttribute('type', 'hidden');
        _pi.setAttribute('name', 'parent');
        _pi.setAttribute('id', 'comment-parent');

        var _form = 'form' == _cf.tagName ? _cf : _cf.getElementsByTagName('form')[0];

        _form.appendChild(_pi);
    }
    _pi.setAttribute('value', coid);

    if (null == document.getElementById('comment-form-place-holder')) {
        var _cfh = document.createElement('div');
        _cfh.setAttribute('id', 'comment-form-place-holder');
        _cf.parentNode.insertBefore(_cfh, _cf);
    }

    1 == style ? (null == _ce.nextSibling ? _cp.appendChild(_cf)
    : _cp.insertBefore(_cf, _ce.nextSibling)) : _ce.appendChild(_cf);

    return false;
};

var typechoCancelCommentReply = function (cfid) {
    var _cf = document.getElementById(cfid),
    _cfh = document.getElementById('comment-form-place-holder');

    var _pi = document.getElementById('comment-parent');
    if (null != _pi) {
        _pi.parentNode.removeChild(_pi);
    }

    if (null == _cfh) {
        return true;
    }

    _cfh.parentNode.insertBefore(_cf, _cfh);
    return false;
};
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size1, sans-serif;"></div></div></body></html>